"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["69634"],{24124:function(e,t,n){n.d(t,{GG:()=>a,R2:()=>o,h7:()=>l,rh:()=>i});var r=n(570140);function l(e,t,n){return new Promise(l=>{setTimeout(()=>{r.Z.dispatch({type:"ACTIVITY_INVITE_MODAL_OPEN",activity:e,isPrivate:t,context:n,resolve:l})},0)})}function i(e){r.Z.dispatch({type:"ACTIVITY_INVITE_MODAL_QUERY",query:e})}function a(e){r.Z.dispatch({type:"ACTIVITY_INVITE_MODAL_SEND",channelId:e})}function o(e){r.Z.dispatch({type:"ACTIVITY_INVITE_MODAL_SEND",userId:e})}},582019:function(e,t,n){n.d(t,{j:()=>o});var r=n(951288),l=n(647438),i=n(709014);let a={all:{name:"all",start:0,duration:66}},o=()=>{let e=l.useRef(null),t=l.useCallback(()=>{null!=e.current&&e.current.play("all")},[]),o=l.useCallback(()=>{null!=e.current&&e.current.play("all")},[]),u=l.useCallback(()=>{null!=e.current&&e.current.stopIfPlaying("all")},[]),s=l.useCallback(t=>{var l,o;return(0,r.jsx)(i.L,(l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),o=o={src:()=>n.e("66944").then(n.t.bind(n,166174,19)),ref:e,markers:a},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(o,e))}),l))},[]);return{events:{onClick:t,onMouseEnter:o,onMouseLeave:u},play:t,getDuration:l.useCallback(()=>{var t;return null==(t=e.current)?void 0:t.getDuration()},[]),getCurrentFrame:l.useCallback(()=>{var t,n;return null!=(n=null==(t=e.current)?void 0:t.getCurrentFrame())?n:null},[]),Component:s}}},638730:function(e,t,n){n.d(t,{T:()=>a,h:()=>o}),n(388685);var r=n(647438),l=n(392711);let i=e=>e,a=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3?arguments[3]:void 0,a=o(i,t,n,l),u=r.useRef(e);return r.useEffect(()=>{u.current=a(e)},[e,a]),0===t?e:u.current},o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,a=r.useRef((0,l.throttle)(e,t,i));return r.useEffect(()=>(a.current=(0,l.throttle)(e,t,i),()=>{var e;null==(e=a.current)||e.cancel()}),[e,t,i,...n]),a.current}},563218:function(e,t,n){n.d(t,{Z:()=>b});var r=n(951288),l=n(647438),i=n(442837),a=n(570140),o=n(523238),u=n(928518),s=n(585483),c=n(317381),d=n(16609),f=n(917107),p=n(716600),m=n(918559),E=n(981631);let g=(e,t)=>{a.Z.wait(()=>{(0,o.Cz)(e,t)})};function b(e){let t,{embedId:n,className:a,style:o}=e,b=(0,i.e7)([u.Z],()=>u.Z.getWindow(E.KJ3.CHANNEL_CALL_POPOUT)),S=(0,p.Z)(),v=(0,i.e7)([c.ZP],()=>c.ZP.getActivityPanelMode());if(null==S||(0,f.Z)((0,d.p)(S.location))||v!==m.Ez.PANEL){var h;t=null!=(h=null==b?void 0:b.window)?h:window}else t=window;let O=l.useRef(null),y=l.useMemo(()=>{let e=null;return()=>{null==e&&(e=t.requestAnimationFrame(()=>{var t,r;g(n,null!=(r=null==(t=O.current)?void 0:t.getBoundingClientRect())?r:null),e=null}))}},[n,t]);return l.useEffect(()=>(t.addEventListener("resize",y),s.S.subscribe(E.CkL.REMEASURE_TARGET,y),()=>{t.removeEventListener("resize",y),s.S.unsubscribe(E.CkL.REMEASURE_TARGET,y)}),[y,t]),l.useLayoutEffect(()=>{let e=O.current;if(null==e)return;let t=e.ownerDocument.defaultView;if(null==t)return;y();let r=new t.ResizeObserver(y);return r.observe(e),()=>{r.disconnect(),g(n,null)}},[n,y]),(0,r.jsx)("div",{ref:O,style:o,className:a})}},655687:function(e,t,n){n.d(t,{Z:()=>a});var r=n(933557),l=n(981631),i=n(388032);function a(e){let{channel:t,isReadonly:n=!1,isCreatingThread:a=!1}=e,o=(0,r.ZP)(t,!0),u=(0,r.ZP)(t,!1);return null==t||null==o?{placeholder:i.intl.string(i.t.MKDeyM),accessibilityLabel:i.intl.string(i.t.MKDeyM)}:a?{placeholder:i.intl.string(i.t.YzpScX),accessibilityLabel:i.intl.string(i.t.YzpScX)}:n?{placeholder:i.intl.string(i.t.RRvRp6),accessibilityLabel:i.intl.string(i.t.RRvRp6)}:t.isForumPost()?{placeholder:i.intl.formatToPlainString(i.t.Y6qWLS,{channel:o}),accessibilityLabel:i.intl.formatToPlainString(i.t.KffKoa,{channel:u})}:l.TPd.THREADS.has(t.type)?{placeholder:i.intl.formatToPlainString(i.t["8lzR/f"],{channel:o}),accessibilityLabel:i.intl.formatToPlainString(i.t.UZIMWV,{channel:u})}:t.type===l.d4z.DM?{placeholder:i.intl.formatToPlainString(i.t["4c+CAw"],{channel:o}),accessibilityLabel:i.intl.formatToPlainString(i.t.fqOxbW,{channel:u})}:{placeholder:i.intl.formatToPlainString(i.t["8lzR/f"],{channel:o}),accessibilityLabel:i.intl.formatToPlainString(i.t.ih7ZSE,{channel:u})}}},175470:function(e,t,n){n.d(t,{n:()=>r});let r=(0,n(879690).U)(e=>({clipsButtonRef:null,setClipsButtonRef:t=>e({clipsButtonRef:t})}))},475674:function(e,t,n){n.d(t,{Z:()=>o}),n(388685),n(642613);var r=n(442837),l=n(458725),i=n(915525);let a={[l.u.STREAM_SOUNDSHARE_FAILED]:0,[l.u.STREAM_SEND_HIGH_PACKET_LOSS]:1,[l.u.STREAM_VIEW_HIGH_PACKET_LOSS]:1,[l.u.STREAM_SEND_LOW_FPS]:2,[l.u.STREAM_VIEW_LOW_FPS]:2,[l.u.STREAM_BAD_NETWORK_QUALITY]:3};function o(e){let t=e.id;return(0,r.e7)([i.Z],()=>{let e=Array.from(i.Z.getActiveErrors().values()).filter(e=>"streamKey"in e&&e.streamKey===t&&null!=a[e.type]).sort((e,t)=>{var n,r;return(null!=(n=a[e.type])?n:0)-(null!=(r=a[t.type])?r:0)})[0];return null==e?void 0:e.type},[t])}},517525:function(e,t,n){n.d(t,{Z:()=>L}),n(388685);var r=n(951288),l=n(647438),i=n(120356),a=n.n(i),o=n(202841),u=n(468194),s=n(442837),c=n(692547),d=n(477690),f=n(481060),p=n(2052),m=n(906732),E=n(194082),g=n(484459),b=n(594174),S=n(626135),v=n(74538),h=n(557457),O=n(475674),y=n(981631),_=n(474936),j=n(388032),Z=n(386393);function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function w(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let P=(0,u.Mg)(d.Z.LIVE_INDICATOR_BORDER_RADIUS),A={opacity:0,transform:"translate3d(100%, 0, 0)"},C={opacity:1,transform:"translate3d(0%, 0, 0)"},R={opacity:0},x={opacity:1},N={borderRadius:"".concat(P,"px ").concat(P,"px ").concat(P,"px ").concat(P,"px")},T={borderRadius:"0px ".concat(P,"px ").concat(P,"px 0px")},D={mass:1,tension:500,friction:18,clamp:!0},M=e=>{let t,i,{participant:o,isUpsellEnabled:u,shape:d,size:g,didTrackUpsellViewed:P,setDidTrackUpsellViewed:A,className:C,premiumIndicator:R,quality:x}=e,{analyticsLocations:N}=(0,m.ZP)(),T=null!=(0,O.Z)(o);try{t=(0,h.nG)(x)}catch(e){t=!1}try{i=(0,h.tR)(x)}catch(e){i=!1}let D=t||i,{location:M}=(0,p.O)(),L=(0,s.e7)([b.default],()=>b.default.getCurrentUser()),F=u&&!v.ZP.isPremium(L,_.p9.TIER_1)&&!v.ZP.canStreamQuality(v.ZP.StreamQuality.MID,L),k=l.useCallback(()=>{F&&D&&(0,f.ZDy)(async()=>{let{default:e}=await n.e("28479").then(n.bind(n,78865));return t=>(0,r.jsx)(e,w(I({},t),{analyticsSource:M}))})},[F,D,M]);if(l.useEffect(()=>{!P&&D&&(S.default.track(y.rMx.PREMIUM_UPSELL_VIEWED,{type:_.cd.STREAM_QUALITY_INDICATOR,has_premium_stream_fps:t,has_premium_stream_resolution:i,location_stack:N}),A(!0))},[t,i,D,P,A,N]),null==x)return null;let V=(0,r.jsx)(f.ua7,{text:T?j.intl.string(j.t.q8TiVl):D?j.intl.string(j.t.IHgpEh):j.intl.string(j.t.vLb0VV),position:"bottom",color:f.ua7.Colors.GREY,children:e=>(0,r.jsxs)(f.P3F,w(I({},e),{onClick:k,className:a()(Z.qualityIndicator,g,E.eE[d],T?Z.qualityIndicatorLowQuality:Z.qualityIndicatorFullQuality,{[Z.clickable]:F&&D}),children:[D?(0,r.jsx)(f.SrA,{size:"md",color:"currentColor",className:Z.premiumStreamIcon}):null,(0,r.jsx)("span",{className:Z.qualityResolution,children:(0,h.ml)(x.maxResolution)}),(0,r.jsx)("span",{children:(0,h.bp)(x.maxFrameRate)})]}))});return(0,r.jsx)(f.IGR,{text:V,className:a()(C,Z.qualityIndicatorBadge,{[Z.qualityIndicatorBadgePremium]:D&&R}),color:c.Z.unsafe_rawColors.PRIMARY_500.css,shape:E.eE[d]})},L=e=>{let{participant:t,showQuality:n,isUpsellEnabled:i=!0,size:u,className:s,premiumIndicator:c}=e,[d,p]=l.useState(!1),m=(0,h.W3)(t),{reducedMotion:b}=l.useContext(f.Sfi),S=n&&null!=m;l.useEffect(()=>{(0,g.Z)(t.stream.ownerId,t.user.getAvatarURL(t.stream.guildId,80),{dispatchWait:!0})},[t]);let v=(0,f.Yzy)(S,{enter:{from:b.enabled?R:A,to:b.enabled?x:C},leave:b.enabled?R:A,config:D},"animate-always"),O=(0,f.q_F)({to:S?T:N,config:D},"animate-always");return(e=>{let{className:n,popoutProps:l}=e;return(0,r.jsxs)("div",w(I({className:a()(Z.streamQualityIndicator,n)},l),{children:[v((e,n)=>n?(0,r.jsx)(o.animated.div,{style:e,children:(0,r.jsx)(M,{className:Z.liveQualityIndicator,participant:t,size:u,shape:f.Dv2.ROUND_LEFT,isUpsellEnabled:i,didTrackUpsellViewed:d,setDidTrackUpsellViewed:p,premiumIndicator:c,quality:m})}):null),(0,r.jsx)(o.animated.div,{style:O,className:Z.liveIndicator,children:(0,r.jsx)(E.ZP,{look:E.jZ.RED,size:u,shape:S?f.Dv2.ROUND_RIGHT:f.Dv2.ROUND})})]}))})({className:s})}},6572:function(e,t,n){n.d(t,{Z:()=>d}),n(388685);var r=n(951288);n(647438);var l=n(120356),i=n.n(l),a=n(442837),o=n(963838),u=n(37091),s=n(388032),c=n(573940);function d(e){let t,{channelId:n,userId:l}=e,[d,f]=(0,a.Wu)([u.Z],()=>[u.Z.getWaitingHighFive(n,l),u.Z.getCompletedHighFive(n,l)]);if(null!=f)t=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{alt:s.intl.string(s.t.W6HwU1),src:(0,o._r)({name:f[0],id:null,animated:!1}),className:i()(c.completeLeft,c.highFive)}),(0,r.jsx)("img",{alt:s.intl.string(s.t.W6HwU1),src:(0,o._r)({name:f[1],id:null,animated:!1}),className:i()(c.completeRight,c.highFive)})]});else{if(null==d)return null;t=(0,r.jsx)("img",{alt:s.intl.string(s.t.W6HwU1),src:(0,o._r)({name:d,id:null,animated:!1}),className:i()(c.waiting,c.highFive)})}return(0,r.jsx)("div",{className:c.root,children:t})}},352978:function(e,t,n){n.d(t,{L:()=>p,Z:()=>m}),n(388685);var r,l=n(951288),i=n(647438),a=n(120356),o=n.n(a),u=n(481060),s=n(885524),c=n(38755),d=n(153066),f=n(412418),p=((r={}).CONTAIN="contain",r.COVER="cover",r);let m=i.memo(function(e){let{streamId:t,onResize:n,wrapperClassName:r,videoComponent:a,className:p,fit:m="contain",mirror:E=!1,paused:g=!1,streamPreviewURL:b,videoSpinnerContext:S,userId:v,streamKey:h}=e,[O,y]=i.useState(!0);(0,c.Z)({location:"VideoStream",videoSpinnerContext:S,userId:v,streamId:t,loading:O,paused:g});let{onReady:_}=(0,s.Z)({streamId:t,userId:v,loading:O,videoSpinnerContext:S,streamKey:h,paused:g}),j=i.useCallback(()=>{y(!1),_()},[_]);return(0,l.jsxs)("div",{className:o()(f.wrapper,r),children:[null!=t&&(0,l.jsx)(a,{className:o()(f.video,(0,d.l)(f,"video",m),{[f.mirror]:E},p),streamId:t,onResize:n,onReady:j,paused:g}),g?null:(0,l.jsx)("div",{className:o()(f.previewWrapper,{[f.loading]:O}),children:O&&(0,l.jsxs)(i.Fragment,{children:[null!=b?(0,l.jsx)("img",{src:b,alt:"",className:f.previewImage}):(0,l.jsx)("div",{className:f.emptyPreviewWrapper,children:(0,l.jsx)("div",{className:f.emptyPreview})}),(0,l.jsx)(u.$jN,{className:f.spinner})]})})]})})},936847:function(e,t,n){n.d(t,{Z:()=>c});var r=n(951288),l=n(647438),i=n(576125),a=n(465858),o=n(112843),u=n(524484);function s(e){let{callTileRef:t,isFiring:n}=e,r=(0,o.Z)(),i=(0,a.Z)(t);return l.useEffect(()=>{n&&null!=i&&null!=t&&r.fire(i.x+t.clientWidth/2,i.y+t.clientHeight/2,{countMultiplier:4})},[t,r,n,i]),null}function c(e){return(0,r.jsx)(i.Z,{confettiLocation:u.Hn.CALL_TILE,children:(0,r.jsx)(s,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))})}},512384:function(e,t,n){n.d(t,{Z:()=>u});var r=n(951288);n(647438);var l=n(399606),i=n(481060),a=n(351780),o=n(170248);function u(e){let{isShaking:t,shakeLocation:n,children:u,className:s}=e,c=(0,o.Z)(n);return(0,l.e7)([a.Z],()=>a.Z.isEnabled({shakeLocation:n}))?(0,r.jsx)(i.UkV,{isShaking:t,intensity:c,className:s,children:u}):u}},170248:function(e,t,n){n.d(t,{Z:()=>a});var r=n(442837),l=n(451478),i=n(351780);function a(e){let t=(0,r.e7)([l.Z],()=>l.Z.isFocused());return(0,r.e7)([i.Z],()=>i.Z.isEnabled({shakeLocation:e})&&t?i.Z.shakeIntensity:0)}},763624:function(e,t,n){n.d(t,{A:()=>o});var r=n(818083);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let a={enableRequestToStream:!1,enableVCStatusIcons:!1,enableOpenTIVForPing:!1,enableRequestToStreamOverlayNotification:!1},o=(0,r.B)({kind:"guild",id:"2025-08_request_to_stream",label:"Request to Stream",defaultConfig:a,treatments:[{id:1,label:"VC Status Icons",config:i(l({},a),{enableVCStatusIcons:!0})},{id:2,label:"Request to Stream without Overlay Notification",config:i(l({},a),{enableVCStatusIcons:!0,enableRequestToStream:!0,enableOpenTIVForPing:!0})},{id:3,label:"Request to Stream with Overlay Notification",config:i(l({},a),{enableVCStatusIcons:!0,enableRequestToStream:!0,enableOpenTIVForPing:!0,enableRequestToStreamOverlayNotification:!0})}]})},98369:function(e,t,n){n.d(t,{Z:()=>Z}),n(388685),n(410992),n(227481),n(730884),n(20464),n(341884),n(364341),n(629680),n(505025),n(918970),n(121784),n(644351),n(146733);var r,l,i=n(442837),a=n(46973),o=n(570140),u=n(569545),s=n(314897),c=n(19780),d=n(959457),f=n(630759),p=n(729303),m=n(651941),E=n(981631);let g=new Map,b=new Map,S=!1,v=null;function h(){return d.Z.getAllActiveStreamKeys().reduce((e,t)=>{let{ownerId:n}=(0,u.my)(t),r=!0===g.get(n),l=b.get(t)!==r;return b.set(t,r),!!l||e},!1)}function O(){var e;let t=null!=(e=c.Z.getUserIds())?e:new Set,n=s.default.getId(),r=!0;for(let e of t)if(n!==e&&!0!==g.get(e)){r=!1;break}let l=r!==S;return S=r,l}function y(e){let{userId:t}=e;if(s.default.getId()===t)return!1;let n=function(e){let t=c.Z.getSecureFramesRosterMapEntry(e);if(null==t)return!1;let n=new Uint8Array(t),r=m.Z.isKeyVerified(e,n)||p.Z.isKeyVerified(e,n),l=(0,f.UB)(e,[c.Z,d.Z]),i=r&&!l,a=i!==g.get(e);return g.set(e,i),a}(t),r=h(),l=O();return n||r||l}function _(){g.clear(),b.clear(),S=!1}class j extends(r=i.ZP.Store){initialize(){this.waitFor(p.Z,m.Z,c.Z,d.Z)}isCallVerified(){return S}isStreamVerified(e){return b.get(e)}isUserVerified(e){return g.get(e)}}(l="displayName")in j?Object.defineProperty(j,l,{value:"SecureFramesVerifiedStore",enumerable:!0,configurable:!0,writable:!0}):j[l]="SecureFramesVerifiedStore";let Z=new j(o.Z,{CONNECTION_OPEN:_,VOICE_CHANNEL_SELECT:function(e){let{channelId:t}=e;if(t===v)return!1;v=t,_()},RTC_CONNECTION_STATE:function(e){let{streamKey:t,state:n,context:r}=e;if(n!==E.hes.DISCONNECTED)return!1;switch(r){case a.Yn.STREAM:if(null==t)return!1;return b.delete(t),O();case a.Yn.DEFAULT:_()}},RTC_CONNECTION_ROSTER_MAP_UPDATE:function(e){let{userIds:t}=e,n=s.default.getId(),r=t.reduce((e,t)=>n===t?e:!!y({userId:t})||e,!1),l=h(),i=O();return r||l||i},SECURE_FRAMES_TRANSIENT_KEY_CREATE:y,SECURE_FRAMES_TRANSIENT_KEY_DELETE:y,SECURE_FRAMES_VERIFIED_KEY_CREATE:y,SECURE_FRAMES_VERIFIED_KEY_DELETE:y,SECURE_FRAMES_USER_VERIFIED_KEYS_DELETE:y})},729303:function(e,t,n){n.d(t,{Z:()=>s}),n(388685),n(410992),n(227481),n(730884),n(20464),n(341884),n(364341),n(629680),n(505025),n(918970),n(121784),n(644351),n(146733);var r,l,i=n(442837),a=n(570140);let o=new Map;class u extends(r=i.ZP.Store){getUsers(){return o}isKeyVerified(e,t){let n=o.get(e);if(null==t||null==n||n.length!==t.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}}(l="displayName")in u?Object.defineProperty(u,l,{value:"TransientKeyStore",enumerable:!0,configurable:!0,writable:!0}):u[l]="TransientKeyStore";let s=new u(a.Z,{CONNECTION_OPEN:function(){o.clear()},SECURE_FRAMES_TRANSIENT_KEY_CREATE:function(e){let{userId:t,key:n}=e,r=new Uint8Array(n);o.set(t,r)},SECURE_FRAMES_TRANSIENT_KEY_DELETE:function(e){let{userId:t}=e;return o.delete(t)}})},441894:function(e,t,n){n.d(t,{J:()=>o}),n(388685);var r=n(442837),l=n(592125),i=n(19780),a=n(760373);function o(e){let{channelId:t}=e;return(0,r.e7)([i.Z,l.Z],()=>(function(e){var t;let[n,r]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[i.Z,l.Z];if(null==e||n.getChannelId()!==e)return!1;let o=r.getChannel(e);if(null==o||o.isGuildStageVoice())return!1;let u=null==(t=n.getSecureFramesState())?void 0:t.version;return null!=u&&u!==a.Eg})(t,[i.Z,l.Z]),[t])}},210975:function(e,t,n){n.d(t,{m$:()=>f,wV:()=>c,zU:()=>d});var r=n(442837),l=n(569545),i=n(314897),a=n(19780),o=n(98369),u=n(277642),s=n(441894);function c(e){let{userId:t,channelId:n}=e,l=(0,s.J)({channelId:n});return(0,r.e7)([o.Z,i.default,a.Z],()=>null!=t&&l&&a.Z.isUserConnected(t)&&i.default.getId()!==t&&o.Z.isUserVerified(t),[l,t])}function d(e){let{streamKey:t,channelId:n}=e,a=(0,s.J)({channelId:n}),c=(0,u.t)(t);return(0,r.e7)([o.Z,i.default],()=>{if(!a||c||null==t)return!1;let e=i.default.getId(),{ownerId:n}=(0,l.my)(t);return n!==e&&o.Z.isStreamVerified(t)},[c,a,t])}function f(e){let{channelId:t}=e,n=(0,s.J)({channelId:t}),l=(0,u.r)();return(0,r.e7)([o.Z],()=>!!n&&!l&&o.Z.isCallVerified(),[l,n])}},125268:function(e,t,n){n.d(t,{AX:()=>s,BR:()=>d,Bo:()=>g,Df:()=>f,LT:()=>b,ZZ:()=>p,cV:()=>c,fW:()=>E,gr:()=>m,oW:()=>u});var r=n(261470),l=n(544891),i=n(570140),a=n(984063),o=n(981631);function u(e,t,n,r,l){i.Z.dispatch({type:"SHARED_CANVAS_DRAW_LINE_POINT",channelId:e,userId:n,lineId:t,streamerId:r,point:l})}function s(e,t,n,r){return l.tn.post({url:o.ANM.SHARED_CANVAS_LINES(e,n),body:{line_id:t,points:r},rejectWithError:!1})}function c(e,t,n,r){i.Z.dispatch({type:"SHARED_CANVAS_UPDATE_LINE_POINTS",userId:t,lineId:e,newPoints:r,streamerId:n})}function d(e,t,n){return l.tn.post({url:o.ANM.SHARED_CANVAS_EMOJI_HOSES(e,t),body:{emoji_hose:n},rejectWithError:!1})}function f(e,t,n){l.tn.del({url:o.ANM.SHARED_CANVAS_EMOJI_HOSE(e,t,n),backoff:new r.Z,rejectWithError:!0})}function p(e,t){t.state=a.f.STOP,i.Z.dispatch({type:"SHARED_CANVAS_UPDATE_EMOJI_HOSE",emojiHose:t,userId:t.userId,streamerId:e})}function m(e,t,n){i.Z.dispatch({type:"SHARED_CANVAS_UPDATE_EMOJI_HOSE",emojiHose:e,userId:t,streamerId:n})}function E(e,t){i.Z.dispatch({type:"SHARED_CANVAS_CLEAR_DRAWABLES",drawables:e,streamerId:t})}function g(e){i.Z.dispatch({type:"SHARED_CANVAS_SET_DRAW_MODE",drawMode:e})}function b(){i.Z.dispatch({type:"TOGGLE_OVERLAY_CANVAS"})}},813900:function(e,t,n){n.d(t,{FO:()=>o,Fq:()=>a,Ks:()=>r,q2:()=>i,qh:()=>l});let r=80,l=48,i=3,a=500,o=5e3},822183:function(e,t,n){n.d(t,{Z:()=>r});let r=(0,n(818083).B)({kind:"guild",id:"2023-01_shared_canvas",label:"Shared Canvas",defaultConfig:{isSharedCanvasEnabled:!1},treatments:[{id:1,label:"Enable Shared Canvas",config:{isSharedCanvasEnabled:!0}}]})},673125:function(e,t,n){n.d(t,{Z:()=>O}),n(539854),n(388685);var r,l=n(442837),i=n(570140),a=n(633302),o=n(594174),u=n(176354),s=n(984063),c=n(88315),d=n(813900);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){f(e,t,n[t])})}return e}let m={},E={},g={},b=!0,S=null;function v(e){if(null==E[e]){let t=o.default.getUser(e);if(null==t)return;let n=t.getAvatarURL(null,d.Ks),r=new Image;r.src=n,E[e]=r}}class h extends(r=l.ZP.Store){get visibleOverlayCanvas(){return b}getDrawables(e){return null!=m[e]?m[e]:[]}getAvatarImage(e){return E[e]}getEmojiImage(e){return g[e]}getDrawMode(){return S}}f(h,"displayName","SharedCanvasStore");let O=new h(i.Z,{SHARED_CANVAS_UPDATE_LINE_POINTS:function(e){let{lineId:t,newPoints:n,userId:r,streamerId:l}=e,i=m[l];if(null==i)m[l]=[{type:s.W.LINE,id:t,userId:r,points:n}];else{let e=i.find(e=>e.id===t);null==e?i.push({type:s.W.LINE,id:t,userId:r,points:n}):(0,c.P7)(e)&&e.points.push(...n)}v(r)},SHARED_CANVAS_UPDATE_EMOJI_HOSE:function(e){var t,n,r,l,i;let{emojiHose:o,streamerId:c,userId:f}=e,E=(l=p({},o),i=i={type:s.W.EMOJI_HOSE},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(i)).forEach(function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(i,e))}),l);if(null==m[c])m[c]=[E];else{let e=m[c].findIndex(e=>e.id===o.id);e>=0?m[c][e]=p({},m[c][e],E):m[c].push(E)}let b=null!=(n=null!=(t=o.emojiId)?t:o.emojiName)?n:"";if(null==g[b]){let e=null!=o.emojiName?a.ZP.convertNameToSurrogate(o.emojiName):null;g[b]=new Image,g[b].src=(0,u.qc)({id:o.emojiId,name:null!=(r=null!=e?e:o.emojiName)?r:"",animated:!1},d.qh)}v(f)},SHARED_CANVAS_CLEAR_DRAWABLES:function(e){let{drawables:t,streamerId:n}=e;if(null!=m[n]){let e=new Set;t.forEach(t=>e.add(t.id)),m[n]=m[n].filter(t=>!e.has(t.id))}},SHARED_CANVAS_SET_DRAW_MODE:function(e){let{drawMode:t}=e;S=t},TOGGLE_OVERLAY_CANVAS:function(e){let{}=e;b=!b}})},984063:function(e,t,n){n.d(t,{W:()=>i,f:()=>a});var r,l,i=((r={}).LINE="line",r.EMOJI_HOSE="emoji_hose",r),a=((l={}).START="START",l.STOP="STOP",l)},88315:function(e,t,n){n.d(t,{P7:()=>m,RR:()=>p,UN:()=>c,bg:()=>E,hn:()=>d,np:()=>f});var r=n(979590),l=n.n(r),i=n(866442),a=n(220082),o=n(594174),u=n(984063),s=n(813900);function c(e){let t=e.current,n=null==t?void 0:t.getContext("2d");null!=t&&null!=n&&n.clearRect(0,0,t.width,t.height)}function d(e,t){let{width:n,height:r,left:l,top:i}=e.getBoundingClientRect();return{x:(t.clientX-l)/n,y:(t.clientY-i)/r}}function f(e,t){return Math.round(e*t*window.devicePixelRatio)}function p(e,t,n){return{x:f(e.x,t),y:f(e.y,n),deltaTime:e.deltaTime}}function m(e){return e.type===u.W.LINE}function E(e,t,n,r){var u;let c=o.default.getUser(e),d=null==c?void 0:c.getAvatarURL(null,s.Ks),f=null!=d?null==(u=a.SR.getState().palette[d])?void 0:u[0]:null,p=null!=f?"#".concat(l()({r:f[0],g:f[1],b:f[2]}).toHex()):r,m=(0,i.Bd)((0,i._i)(p))>.5?n:t;return{fillColor:p,outlineColor:m}}},199766:function(e,t,n){n.d(t,{I:()=>l,T:()=>i});var r=n(673125);function l(e,t,n,r,l){e.save(),e.beginPath(),e.fillStyle=r,e.arc(t,n,Math.round(20*window.devicePixelRatio)/2+l,0,2*Math.PI),e.fill(),e.restore()}function i(e,t,n,l){e.save();let i=r.Z.getAvatarImage(l);if(null==i)return;let a=20*window.devicePixelRatio;e.beginPath(),e.arc(t,n,a/2,0,2*Math.PI),e.clip(),e.drawImage(i,t-a/2,n-a/2,a,a),e.restore()}},262433:function(e,t,n){n.d(t,{U:()=>E,Z:()=>b}),n(539854);var r=n(392711),l=n.n(r),i=n(772848),a=n(879690),o=n(731965),u=n(125268),s=n(673125),c=n(984063),d=n(88315),f=n(199766),p=n(813900);let m={X_OFFSET:2*p.qh,Y_OFFSET:25,X_SPEED:.5,Y_SPEED_MIN:-1,Y_SPEED_MAX:-5,OPACITY:1,OPACITY_SPEED_MIN:.01,OPACITY_SPEED_MAX:.05,SIZE_MIN:p.qh/2,SIZE_MAX:p.qh},E=(0,a.U)(()=>({particles:{},lastSpawned:{}}));function g(e,t){var n;l()(null!=(n=E.getState().particles[e.id])?n:{}).forEach(t)}function b(e){var t,n,r;let{emojiHose:a,context:b,canvasWidth:S,canvasHeight:v,fallbackColor:h,outlineColorDark:O,outlineColorLight:y,streamerId:_,deadDrawables:j}=e;b.save();let Z=s.Z.getEmojiImage(null!=(n=null!=(t=a.emojiId)?t:a.emojiName)?n:""),I=(0,d.np)(a.x,S),w=(0,d.np)(a.y,v),{outlineColor:P}=(0,d.bg)(a.userId,O,y,h);g(a,e=>{e.x+=e.xSpeed*window.devicePixelRatio,e.y+=e.ySpeed*window.devicePixelRatio,e.opacity-=e.opacitySpeed,e.opacity<=0&&(0,o.j)(()=>{E.setState(t=>(delete t.particles[a.id][e.id],0===Object.keys(t.particles[a.id]).length&&delete t.particles[a.id],t))})}),function(e,t,n){var r;let a=null!=(r=E.getState().lastSpawned[e.id])?r:0,u=Date.now();!(a+100>u)&&e.state!==c.f.STOP&&(.8>=Math.random()||a+300<u)&&(0,o.j)(()=>{E.setState(r=>{var a;let o=null!=(a=r.particles[e.id])?a:{},u=l().random(1,2);for(let e=0;e<u;e++){let e={id:(0,i.Z)(),x:t+l().random(-m.X_OFFSET,m.X_OFFSET),y:n+l().random(-m.Y_OFFSET,m.Y_OFFSET),xSpeed:l().random(-m.X_SPEED,m.X_SPEED),ySpeed:l().random(m.Y_SPEED_MIN,m.Y_SPEED_MAX),opacity:m.OPACITY,opacitySpeed:l().random(m.OPACITY_SPEED_MIN,m.OPACITY_SPEED_MAX),size:l().random(m.SIZE_MIN,m.SIZE_MAX)};o[e.id]=e}return r.particles[e.id]=o,r.lastSpawned[e.id]=Date.now(),r})})}(a,I,w),(0,f.I)(b,I,w,P,p.q2),(0,f.T)(b,I,w,a.userId),g(a,e=>(function(e,t,n){if(null==t)return;let r=n.size*window.devicePixelRatio,l=n.x-r/2*window.devicePixelRatio,i=n.y-1.2*r*window.devicePixelRatio;e.globalAlpha=n.opacity,e.drawImage(t,r/2+l,r/2+i,r,r)})(b,Z,e)),a.lastUpdatedAt+p.FO<Date.now()&&(0,u.ZZ)(_,a),a.state!==c.f.STOP||Object.keys(null!=(r=E.getState().particles[a.id])?r:{}).length>0||j.push(a),b.restore()}},400321:function(e,t,n){n.d(t,{Z:()=>a}),n(539854);var r=n(88315),l=n(199766),i=n(813900);function a(e){let{line:t,context:n,canvasWidth:a,canvasHeight:o,fallbackColor:u,outlineColorDark:s,outlineColorLight:c,linesDrawnAt:d,deadDrawables:f}=e;null==d.current[t.id]&&(d.current[t.id]=Date.now()),n.lineCap="round",n.lineJoin="round";let p=t.points.map(e=>(0,r.RR)(e,a,o)),m=d.current[t.id],E=e=>m+e.deltaTime+1500>=Date.now(),g=e=>m+e.deltaTime<=Date.now()&&E(e),b=p.find(g);if(null==b){E(t.points[t.points.length-1])||f.push(t);return}let S=(e,t)=>{let r=null;n.lineWidth=t*window.devicePixelRatio,n.strokeStyle=e,n.beginPath(),n.moveTo(b.x,b.y);for(let e=1;e<p.length;e++){let t=p[e];g(t)&&(n.lineTo(t.x,t.y),r=t)}return n.stroke(),r},{fillColor:v,outlineColor:h}=(0,r.bg)(t.userId,s,c,u),O=S(h,6+i.q2),y=null!=O&&g(O);y&&(0,l.I)(n,O.x,O.y,h,i.q2),S(v,6),y&&(0,l.T)(n,O.x,O.y,t.userId)}},179295:function(e,t,n){n.d(t,{Z:()=>c});var r=n(647438),l=n(442837),i=n(569545),a=n(959457),o=n(626135),u=n(981631),s=n(474936);function c(e,t){let{handleMouseDown:n,handleMouseMove:c,handleMouseUp:d,handleMouseEnter:f}=e,p=r.useRef(null),m=(0,l.e7)([a.Z],()=>a.Z.getRTCConnection((0,i.V9)(t))),E=r.useCallback((e,t,r)=>{p.current=Date.now(),n(e,t,r)},[n]);return{handleMouseUp:r.useCallback((e,t,n)=>{if(d(e,t,n),null!=p.current){var r;null!=m&&(r=Date.now()-p.current,o.default.track(u.rMx.PREMIUM_FEATURE_USAGE,{feature_name:"".concat(s.QP.SHARED_CANVAS,"_").concat(e.type),feature_tier:s.h1.FREE,media_session_id:m.getMediaSessionId(),parent_media_session_id:m.parentMediaSessionId,guild_id:m.guildId,duration:r})),p.current=null}},[d,m]),handleMouseDown:E,handleMouseMove:c,handleMouseEnter:f}}},370663:function(e,t,n){n.d(t,{Z:()=>o});var r=n(647438),l=n(772848),i=n(125268);let a=()=>{};function o(e,t,n){let o=r.useRef((0,l.Z)()),u=r.useRef(Date.now()),s=r.useCallback((r,l)=>{let a={x:r,y:l,deltaTime:Date.now()-u.current};(0,i.oW)(t,o.current,e,n,a),(0,i.cV)(o.current,e,n,[a])},[t,n,e]),c=r.useCallback((e,t,n)=>{o.current=(0,l.Z)(),u.current=Date.now(),s(t,n)},[s]),d=r.useCallback((e,t,n)=>s(t,n),[s]),f=r.useCallback((e,t,n)=>c(e,t,n),[c]);return r.useMemo(()=>({handleMouseDown:c,handleMouseMove:d,handleMouseUp:a,handleMouseEnter:f}),[c,f,d])}},743597:function(e,t,n){n.d(t,{Z:()=>m});var r=n(647438),l=n(392711),i=n.n(l),a=n(772848),o=n(846519),u=n(125268),s=n(984063),c=n(813900);function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function f(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let p=i().debounce(u.BR,c.Fq,{maxWait:c.Fq});function m(e,t,n){let l=r.useRef((0,a.Z)()),i=r.useRef(new o.Xp),m=r.useCallback(r=>{r.lastUpdatedAt=Date.now(),(0,u.gr)(r,e,n),(0,u.BR)(t,n,r)},[t,n,e]),E=r.useCallback((r,o,p)=>{l.current=(0,a.Z)();let E=f(d({},r),{id:l.current,x:o,y:p,userId:e,state:s.f.START,lastUpdatedAt:Date.now()});(0,u.BR)(t,n,E),(0,u.gr)(E,e,n),i.current.start(c.FO,()=>m(E))},[e,t,n,m]),g=r.useCallback((r,a,o)=>{let E=f(d({},r),{id:l.current,x:a,y:o,userId:e,state:s.f.START,lastUpdatedAt:Date.now()});p(t,n,E),(0,u.gr)(E,e,n),i.current.start(c.FO,()=>m(E))},[e,t,n,m]),b=r.useCallback((r,a,o)=>{p.cancel(),(0,u.Df)(t,n,l.current),(0,u.gr)(f(d({},r),{id:l.current,x:a,y:o,userId:e,state:s.f.STOP,lastUpdatedAt:Date.now()}),e,n),i.current.stop()},[t,n,e]),S=r.useCallback((e,t,n)=>g(e,t,n),[g]);return r.useMemo(()=>({handleMouseDown:E,handleMouseMove:g,handleMouseUp:b,handleMouseEnter:S}),[E,S,g,b])}},364125:function(e,t,n){n.d(t,{Z:()=>d});var r=n(647438),l=n(399606),i=n(673125),a=n(984063),o=n(88315),u=n(179295),s=n(370663),c=n(743597);function d(e){let{user:t,channelId:n,streamerId:d,stream:f,focused:p,canvas:m}=e,E=r.useRef(!1),g=(0,l.e7)([i.Z],()=>i.Z.getDrawMode()),b=(0,u.Z)((0,s.Z)(t.id,n,d),f),S=(0,u.Z)((0,c.Z)(t.id,n,d),f),v=r.useCallback((e,t,n)=>{if(null==m)return;let{x:r,y:l}=(0,o.hn)(m,n);switch(t.type){case a.W.LINE:return b[e](t,r,l);case a.W.EMOJI_HOSE:return S[e](t,r,l)}},[m,b,S]),h=r.useCallback(e=>{p&&null!=g&&(e.stopPropagation(),E.current=!0,v("handleMouseDown",g,e))},[v,g,p]),O=r.useCallback(e=>{p&&null!=g&&(e.stopPropagation(),E.current&&v("handleMouseMove",g,e))},[v,g,p]),y=r.useCallback(e=>{p&&null!=g&&(e.stopPropagation(),E.current=!1,v("handleMouseUp",g,e))},[v,g,p]),_=r.useCallback(e=>{E.current&&null!=g&&v("handleMouseEnter",g,e)},[v,g]);return r.useEffect(()=>{let e=e=>{null!=g&&(E.current=!1,v("handleMouseUp",g,e))};return window.addEventListener("mouseup",e),()=>window.removeEventListener("mouseup",e)},[v,g]),{handleClick:r.useCallback(e=>{p&&null!=g&&e.stopPropagation()},[g,p]),handleMouseDown:h,handleMouseEnter:_,handleMouseMove:O,handleMouseUp:y}}},590076:function(e,t,n){n.d(t,{Z:()=>E});var r=n(951288),l=n(647438),i=n(512722),a=n.n(i),o=n(399606),u=n(618158),s=n(594174),c=n(822183),d=n(364125),f=n(90753),p=n(806777);function m(e){let{focused:t,channelId:n,streamerId:i,stream:c}=e,m=l.useRef(null),E=(0,o.e7)([s.default],()=>s.default.getCurrentUser());a()(null!=E,"user cannot be null"),(0,f.Z)(m,E,i,n);let{handleClick:g,handleMouseDown:b,handleMouseEnter:S,handleMouseMove:v,handleMouseUp:h}=(0,d.Z)({user:E,channelId:n,streamerId:i,stream:c,focused:t,canvas:m.current});return(0,r.jsx)(u.Z,{children:(0,r.jsx)("canvas",{ref:m,onClick:g,onMouseDown:b,onMouseEnter:S,onMouseMove:v,onMouseUp:h,className:p.sharedCanvas})})}function E(e){let{isSharedCanvasEnabled:t}=c.Z.useExperiment({guildId:e.guildId,location:"d0de1c_1"},{autoTrackExposure:!0});return!t||e.hasScreenMessage?null:(0,r.jsx)(m,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}},90753:function(e,t,n){n.d(t,{Z:()=>b}),n(539854);var r=n(647438),l=n(846519),i=n(692547),a=n(481060),o=n(220082),u=n(979651),s=n(125268),c=n(673125),d=n(984063),f=n(88315),p=n(262433),m=n(400321),E=n(813900);let g=1e3/60;function b(e,t,n,b){let S=(0,a.dQu)(i.Z.unsafe_rawColors.BRAND_500).hex(),v=(0,a.dQu)(i.Z.unsafe_rawColors.BLACK_500).hex(),h=(0,a.dQu)(i.Z.unsafe_rawColors.WHITE_500).hex(),O=r.useRef({}),y=r.useRef(new l.Xp),_=r.useCallback(t=>{let n=c.Z.getDrawables(t);(0,f.UN)(e),function(e){let{canvasRef:t,drawables:n,fallbackColor:r,linesDrawnAt:l,streamerId:i,channelId:a,outlineColorDark:o,outlineColorLight:c}=e;if(0===n.length)return;let f=t.current;if(null==f)return;let E=f.getContext("2d");if(null==E)return;let{width:g,height:b}=f.getBoundingClientRect(),S=[];n.forEach(e=>{if(null==u.Z.getVoiceStateForChannel(a,e.userId))return void S.push(e);!function(e){let{drawable:t,context:n,canvasWidth:r,canvasHeight:l,fallbackColor:i,outlineColorDark:a,outlineColorLight:o,linesDrawnAt:u,streamerId:s,deadDrawables:c}=e;switch(t.type){case d.W.LINE:return(0,m.Z)({line:t,context:n,canvasWidth:r,canvasHeight:l,fallbackColor:i,outlineColorDark:a,outlineColorLight:o,linesDrawnAt:u,deadDrawables:c});case d.W.EMOJI_HOSE:return(0,p.Z)({emojiHose:t,context:n,canvasWidth:r,canvasHeight:l,fallbackColor:i,outlineColorDark:a,outlineColorLight:o,streamerId:s,deadDrawables:c})}}({drawable:e,context:E,canvasWidth:g,canvasHeight:b,fallbackColor:r,outlineColorDark:o,outlineColorLight:c,linesDrawnAt:l,deadDrawables:S,streamerId:i})}),S.length>0&&(0,s.fW)(S,i)}({canvasRef:e,drawables:n,fallbackColor:S,linesDrawnAt:O,streamerId:t,outlineColorDark:v,outlineColorLight:h,channelId:b})},[e,b,S,v,h]);r.useEffect(()=>{let t=new ResizeObserver(()=>{let t=e.current;if(null==t)return;let{width:r,height:l}=t.getBoundingClientRect();t.width=r*window.devicePixelRatio,t.height=l*window.devicePixelRatio,_(n)});return null!=e.current&&t.observe(e.current),()=>t.disconnect()},[e,_,n]);let j=r.useCallback(()=>{let t=c.Z.getDrawables(n),r=p.U.getState().particles,l=t.length>0||Object.keys(r).length>0;l&&null==y.current._ref&&(null==y.current._ref?(_(n),y.current.start(g,()=>_(n))):l||null==y.current._ref||(y.current.stop(),(0,f.UN)(e)))},[e,_,n]);r.useEffect(()=>{let e=y.current;return c.Z.addChangeListener(j),j(),(0,o.vM)(t.getAvatarURL(null,E.Ks)),()=>{c.Z.removeChangeListener(j),e.stop()}})}},584729:function(e,t,n){n.d(t,{Z:()=>o});var r=n(271383),l=n(5192),i=n(354459),a=n(388032);function o(e,t,n){var o,u;if(t.type===i.fO.ACTIVITY)return null!=(u=null==n?void 0:n.name)?u:null;let s=r.ZP.isGuestOrLurker(e.guild_id,null==(o=t.user)?void 0:o.id);return l.ZP.getName(e.getGuildId(),e.id,t.user)+(s?" ".concat(a.intl.string(a.t["pFO/Pj"])):"")}},44136:function(e,t,n){n.d(t,{ZP:()=>l}),n(442837),n(314897),n(131951);var r=n(354459);function l(e){var t,n;return e.type!==r.fO.ACTIVITY&&((0,r._5)(e)?null!=e.streamId:null!=(n=null==(t=e.voiceState)?void 0:t.selfVideo)&&n)}},334374:function(e,t,n){n.d(t,{Z:()=>u}),n(388685),n(35282),n(784620),n(973216);var r=n(951288),l=n(647438),i=n(414910),a=n(226961),o=n(447661);function u(e){let{currentUserId:t,participant:n}=e,u=(0,i.Z)(n.type),[s,c]=l.useState(),[d,f]=l.useState(),[p,m]=l.useState(),E=n.id.split(":").at(-1),g=t===E,b=l.useCallback((e,t,n)=>{var r,l,i;let o=n?a.ZP.getOutboundStats(t):a.ZP.getInboundStats(e,t);c(null!=(r=null==o?void 0:o.codec)?r:"unknown"),f(void 0===(l=null==o?void 0:o.resolution)||0===l.width&&0===l.height?"unknown":l.width+" x "+l.height),m((null==o?void 0:o.bitrateEstimate)!==void 0?(i=o.bitrateEstimate,"".concat((i/1e3).toFixed(2)," Kbps")):"unknown")},[]);return l.useEffect(()=>{let e=()=>b(E,u,g);e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[g,E,u,b]),(0,r.jsxs)("div",{className:o.streamInfoContainer,children:[(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:"Stream Info"})}),(0,r.jsxs)("div",{className:o.infoRow,children:[(0,r.jsx)("span",{children:"Video Codec: "}),(0,r.jsx)("strong",{children:s})]}),(0,r.jsxs)("div",{className:o.infoRow,children:[(0,r.jsx)("span",{children:"Resolution: "}),(0,r.jsx)("strong",{children:d})]}),g&&(0,r.jsxs)("div",{className:o.infoRow,children:[(0,r.jsx)("span",{children:"Bitrate Estimate: "}),(0,r.jsx)("strong",{children:p})]})]})}},849171:function(e,t,n){n.d(t,{OV:()=>M,ZP:()=>F}),n(388685);var r=n(951288),l=n(647438),i=n(120356),a=n.n(i),o=n(442837),u=n(755721),s=n(481060),c=n(2052),d=n(317381),f=n(638880),p=n(413458),m=n(16609),E=n(527805),g=n(716600),b=n(778569),S=n(563218),v=n(318891),h=n(884338),O=n(719296),y=n(958185),_=n(100527),j=n(906732),Z=n(890280),I=n(835473),w=n(522474),P=n(314897),A=n(819640),C=n(594174),R=n(823379),x=n(5192),N=n(388032),T=n(798242);let D=["embedded_background"];function M(e){let{avatarSize:t,guildId:n,channelId:l,users:i}=e,a=null!=t?t:s.EFr.SIZE_32,o=(0,s.pxk)(a);return(0,r.jsx)(h.ZP,{size:o,guildId:n,users:i,max:4,renderUser:e=>{if(null==e||e===h.ag)return null;let t=x.ZP.getName(n,l,e);return(0,r.jsx)(s.DY3,{text:t,color:s.FGA.GREY,children:(0,r.jsx)("img",{src:e.getAvatarURL(n,o),alt:t,className:T.avatar},e.id)},e.id)}})}function L(e){var t,n;let{participants:i,application:m,channel:g,width:b}=e,S=b>400?2:+(b>300),[v]=b>400?[s.EFr.SIZE_56,56]:b>300?[s.EFr.SIZE_32,32]:[s.EFr.SIZE_24,24],h=(0,o.Wu)([C.default,P.default],()=>Array.from(i).map(e=>(0,p.J)(e,P.default)?null:C.default.getUser(e.userId)).filter(R.lm)),O=(0,o.e7)([d.ZP],()=>{var e;return null!=(e=d.ZP.getEmbeddedActivitiesForChannel(g.id).find(e=>e.applicationId===m.id))?e:d.ZP.getEmbeddedActivitiesForStartingChannel(g.id).find(e=>e.applicationId===m.id)}),{analyticsLocations:y}=(0,j.ZP)(),_=(0,c.O)(),I=x.ZP.getName(g.getGuildId(),g.id,null==h?void 0:h[0]),w=(0,E.s5)({userId:null==(t=C.default.getCurrentUser())?void 0:t.id,channelId:g.id,application:m})===E.Fw.CAN_JOIN,A=null!=(n=g.getGuildId())?n:void 0,D=l.useId(),L=m.id,F=l.useMemo(()=>({channel:g,type:"channel"}),[g]),{submitting:k}=(0,Z.Z)({applicationId:L,context:F,launchingComponentId:D});return(0,r.jsxs)("div",{className:T.splash,children:[(0,r.jsx)(M,{avatarSize:v,guildId:A,channelId:g.id,users:h}),(0,r.jsx)(s.Text,{className:a()(T.subheader,{[T.small]:0===S,[T.medium]:1===S}),variant:"text-sm/normal",children:h.length>1?N.intl.formatToPlainString(N.t.cpe6CA,{username:I,count:h.length-1}):N.intl.formatToPlainString(N.t["7Uuia2"],{username:I})}),(0,r.jsx)(s.Text,{className:a()(T.header,{[T.small]:0===S,[T.medium]:1===S}),variant:"text-sm/normal",children:m.name}),(0,r.jsx)("div",{className:T.buttons,children:w?(0,r.jsx)(u.zx,{onClick:function(e){e.stopPropagation(),null!=O&&(0,f.Z)({applicationId:O.applicationId,activityChannelId:g.id,locationObject:_.location,analyticsLocations:y,componentId:D})},submitting:k,size:function(e){switch(e){case 2:return u.zx.Sizes.LARGE;case 1:return u.zx.Sizes.MEDIUM;case 0:return u.zx.Sizes.SMALL}}(S),className:T.button,look:u.iL.FILLED,color:u.zx.Colors.WHITE,children:N.intl.string(N.t["4i2vj4"])}):null})]})}function F(e){let{participant:t,width:n,selected:i,interactible:a,channel:u}=e,{analyticsLocations:s}=(0,j.ZP)(_.Z.ACTIVITY_TILE),{applicationId:c}=t,d=(0,g.Z)(),f=null!=d&&(0,m.p)(d.location)===u.id&&d.applicationId===c,[p]=(0,I.Z)([c]),{url:E}=(0,b.Z)({applicationId:c,names:D,size:1024}),h=!i&&f,Z=!f,P=!f&&!i,C=(0,o.e7)([A.Z,w.Z],()=>(0,y.Z)({LayerStore:A.Z,PopoutWindowStore:w.Z}));return l.useEffect(()=>{if(h&&null!=d&&!C){let e=(0,O.Z)(d.location.id,d.applicationId);(0,v.jy)(e)}},[h,d,C]),(0,r.jsx)(j.Gt,{value:s,children:(0,r.jsxs)("div",{className:T.container,children:[h&&null!=d&&(0,r.jsx)(S.Z,{className:T.iframe,embedId:(0,O.Z)(d.location.id,c)}),Z&&null!=p&&null!=E&&""!==E?(0,r.jsx)("img",{className:T.splashImage,alt:p.name,src:E}):null,P&&null!=p&&(0,r.jsx)(L,{width:n,channel:u,participants:t.participants,application:p}),a||Z?null:(0,r.jsx)("div",{className:T.clickShield})]})})}},796638:function(e,t,n){n.d(t,{ZB:()=>b,ZP:()=>S,cF:()=>p}),n(388685),n(539854);var r=n(951288),l=n(647438),i=n(392711),a=n(933546),o=n(314897),u=n(70956),s=n(823379),c=n(27457),d=n(354459),f=n(699966);let p=112,m=16/9*112+8,E=10*u.Z.Millis.SECOND;function g(e){var t;let n=o.default.getId();return e.type===d.fO.USER&&e.user.id===n&&(null==(t=e.voiceState)?void 0:t.selfVideo)}function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{tileWidth:m,tileMinWidth:124,tileMargin:8,limit:12,cropSelfVideo:!1},{tileWidth:r,tileMinWidth:o,tileMargin:u,limit:c,cropSelfVideo:f,version:p}=n,[b,S]=l.useState(Date.now());l.useEffect(()=>{let e=setTimeout(()=>{S(Date.now())},E);return()=>{clearTimeout(e)}},[t]);let v=l.useRef({}),{visibleParticipants:h,participantTileWidth:O}=l.useMemo(()=>{let n=Date.now(),l=(0,i.sortBy)(t,e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();switch(e.type){case d.fO.ACTIVITY:return"\x01".concat(e.sortKey);case d.fO.HIDDEN_STREAM:case d.fO.STREAM:return"\x02".concat((0,a.Z)(e.userNick,e.user));case d.fO.USER:var n;let r="\x06";return e.speaking?r="\x03":t-e.lastSpoke<E?r="\x04":(null==(n=e.voiceState)?void 0:n.selfVideo)&&(r="\x05"),"".concat(r).concat(function(e){let t=String(864e13).length;return String(864e13-e).padStart(t,"0")}(e.lastSpoke)).concat((0,a.Z)(e.userNick,e.user))}})(e,n)),[p,m]=(0,i.partition)(l,d.Io),b=p.findIndex(g),S=null;-1!==b&&(S=p[b],p.splice(b,1));let h=null==S||f?e:e-r-u,O=Math.max(0,Math.min(Math.floor((h-u)/(o+u)),c,t.length)),y=Math.min((h-u)/O-u,r),_=Math.max(0,O-m.length),j=m.slice(0,O),Z=p.slice(0,_),I=Array(_);if(_>0){let e=[];for(let t of Z){let n=v.current[t.id];null!=n&&n<_?I[n]=t:e.push(t)}for(let t=0;t<I.length;t++){if(null!=I[t])continue;let n=e.shift();if(null==n)break;I[t]=n}}let w=I.filter(s.lm);v.current=(0,i.keyBy)((0,i.range)(w.length),e=>w[e].id);let P=[...j,...w];return null!=S&&(f&&P.length>=O?P[Math.max(0,P.length-1)]=S:P.push(S)),{visibleParticipants:P,participantTileWidth:y}},[e,t,b,p,f,c,u,o,r]);return{visibleParticipants:h,participantTileWidth:O}}function S(e){let{participants:t,participantTileWidth:n,selectedParticipantId:l,onDoubleClick:i,onContextMenu:a,onClick:o,channel:u,inCall:s,popoutWindow:d,paused:p=!1}=e,E=null!=d;return(0,r.jsx)("div",{className:f.root,children:t.map(e=>{if(null==e)return null;let t=g(e);return(0,r.jsx)("div",{className:f.tileSizer,style:t?{flexShrink:0}:void 0,children:(0,r.jsx)(c.ZP,{participant:e,selected:l===e.id,channel:u,className:f.tile,fit:c.BP.COVER,onClick:o,onDoubleClick:i,onContextMenu:a,width:t?m:n,inCall:s,paused:p,inPopout:E})},e.id)})})}},442168:function(e,t,n){n.d(t,{Z:()=>h});var r=n(951288),l=n(647438),i=n(202841),a=n(442837),o=n(780384),u=n(481060),s=n(435064),c=n(39604),d=n(175470),f=n(569545),p=n(314910),m=n(565063);function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}let g={visibility:"hidden"},b={precision:1e-4,duration:300},S={tension:150,friction:20,precision:1e-4,bounce:0},v={duration:1e3};function h(e){let{stream:t,inPopout:n}=e,{reducedMotion:h}=l.useContext(o.Sf),O=(0,l.useRef)(null),y=d.n.getState().clipsButtonRef,_=(0,f.V9)(t),j=(0,a.e7)([s.Z],()=>s.Z.getActiveAnimation()),Z=(0,a.Wu)([s.Z],()=>s.Z.getStreamClipAnimations(_)),I=(0,l.useRef)(void 0);l.useEffect(()=>()=>{(0,c.Gh)(_)},[_]);let w=e=>{let t=null==y?void 0:y.getBoundingClientRect();if(I.current=t,e.timestamp!==j||null==t||n)return g;let{top:r,left:l}=t;return{top:r+36,left:l-216,height:151,width:268}},P=(0,l.useRef)(null),A=(0,u.Yzy)(Z,{keys:e=>e.timestamp,ref:P,from:{opacity:.2},enter:{opacity:0},config:b},"animate-always"),C=(0,l.useRef)(null),R=(0,u.Yzy)(Z,{ref:C,keys:e=>e.timestamp,from:e=>E({position:"fixed",visibility:"hidden",opacity:1},h.enabled?w(e):(()=>{var e;let t=null==(e=O.current)?void 0:e.getBoundingClientRect();return null==t||n?g:{width:t.width,height:t.height,top:t.top,left:t.left}})()),enter:e=>[E({opacity:1,visibility:"visible"},w(e))],leave:E({opacity:0},!h.enabled&&E({height:0,width:0},(()=>{if(null!=I.current)return{top:I.current.top+12,left:I.current.left+12}})())),config:h.enabled?v:S,onRest:(e,t)=>{null!=t.item&&null!=Z.find(e=>e.timestamp===t.item.timestamp)&&(0,c.Gh)(_,t.item.timestamp)}},"animate-always");return(0,i.useChain)([P,C],[0,.1],3e3),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:m.hidden,ref:O}),A((e,t)=>null!=t&&(0,r.jsx)(i.animated.div,{className:m.whiteFlash,style:e})),(0,r.jsx)(p.ZP,{children:(0,r.jsx)("div",{className:m.hidden,children:R((e,t,n,l)=>(null==t?void 0:t.thumbnail)!=null&&(0,r.jsx)(i.animated.img,{src:t.thumbnail,className:m.movingImage,style:e}))})})]})}},979425:function(e,t,n){n.d(t,{Z:()=>c});var r=n(951288);n(647438);var l=n(120356),i=n.n(l),a=n(481060),o=n(871118),u=n(388032),s=n(7504);function c(e){let{stream:t,isSmall:n,selected:l,isSelfStream:c}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:i()(s.absoluteFill,s.streamPreviewOpacity),stream:t,noText:!0}),!l&&(0,r.jsxs)("div",{className:i()(s.content,s.streamUnavailable,{[s.small]:n}),children:[(0,r.jsx)(a.Text,{className:s.streamUnavailableText,color:"always-white",variant:n?"text-sm/semibold":"text-md/semibold",children:c?u.intl.string(u.t.UeEwj4):u.intl.string(u.t["1i3tSU"])}),(0,r.jsx)(a.DY3,{text:c?u.intl.string(u.t["ro/HNz"]):u.intl.string(u.t.UPf6ZG),className:s.darkCircle,children:(0,r.jsx)("div",{children:(0,r.jsx)(a.o8v,{size:"md",color:"currentColor",className:s.stopStreamIcon,colorClass:s.stopStreamForeground})})})]})]})}},833519:function(e,t,n){n.d(t,{Z:()=>Y,_:()=>W});var r=n(951288),l=n(647438),i=n(120356),a=n.n(i),o=n(442837),u=n(481060),s=n(475179),c=n(872810),d=n(493773),f=n(763520),p=n(194082),m=n(710845),E=n(965048),g=n(590293),b=n(863908),S=n(871118),v=n(517525),h=n(352978),O=n(590076),y=n(507675),_=n(199902),j=n(314897),Z=n(592125),I=n(131951),w=n(451478),P=n(685203),A=n(112560),C=n(442168),R=n(822296),x=n(916771),N=n(792517),T=(n(351483),n(979425)),D=n(651183),M=n(623825),L=n(981631),F=n(354459),k=n(65154),V=n(388032),U=n(7504);let H=new m.Z("StreamTile");function W(e){let{participant:t,selected:n,focused:l,idle:i,width:a,premiumIndicator:u}=e,s=(0,o.e7)([_.Z],()=>_.Z.getActiveStreamForUser(t.user.id,t.stream.guildId)),c=(0,M.K)(a);return(0,r.jsxs)(r.Fragment,{children:[n||l?null:(0,r.jsx)(D.Z,{participant:t}),l||null==s||s.state===L.jm8.ENDED||s.state===L.jm8.FAILED?null:(0,r.jsx)(v.Z,{size:p.ZP.Sizes.SMALL,className:U.liveIndicator,participant:t,showQuality:!c&&!i,isUpsellEnabled:!1,premiumIndicator:u})]})}function Y(e){let{participant:t,selected:n,onVideoResize:i,fit:p,inPopout:m,inOverlayPopout:v=!1,width:D,focused:M,wrapperClassName:W,paused:Y=!1}=e,z=I.Z.getVideoComponent(),G=(0,o.e7)([j.default],()=>j.default.getId()),K=(0,g.Z)(),{stream:q,user:B,streamId:J}=t,X=(0,o.e7)([Z.Z],()=>Z.Z.getChannel(q.channelId)),Q=(0,o.e7)([_.Z],()=>_.Z.getActiveStreamForUser(B.id,q.guildId),[B.id,q.guildId]),$=(0,o.e7)([_.Z],()=>_.Z.getAllActiveStreams().length>0),ee=(0,o.e7)([w.Z],()=>w.Z.isFocused()),et=(null==Q?void 0:Q.ownerId)===G,en=et&&!ee&&!m,er=null!=Q?(0,b.Z)(Q,B,B.id===G,en):null,el=D<195;(0,d.ZP)(()=>{!$&&(null==X?void 0:X.isGuildStageVoice())&&!et&&((0,c.rn)(q),s.Z.updateStageStreamSize(q.channelId,!1))});let ei=(0,E.c)(k.Yn.STREAM,t.user.id);if(l.useEffect(()=>{H.info("Stream Tile State - activeStream: ".concat(null!=Q," | selected: ").concat(n," | Video: ").concat(null!=z," | MediaEngine: ").concat(I.Z.supports(k.AN.VIDEO)))},[z,Q,n]),K)return(0,r.jsx)(T.Z,{stream:t.stream,isSmall:el,selected:n,isSelfStream:B.id===G});if((null==Q?void 0:Q.state)===L.jm8.ENDED)return(0,r.jsx)(R.Z,{selected:n,stream:Q,width:D});if(null!=ei||(null==Q?void 0:Q.state)===L.jm8.FAILED)return(0,r.jsx)(x.Z,{avError:null==ei?void 0:ei.type,avErrorContext:ei,selected:n,stream:t.stream,width:D});if(t.type===F.fO.HIDDEN_STREAM)return(0,r.jsx)(N.Z,{selected:n,participant:t,width:D});if(!(null!=Q&&!n&&null!=z&&I.Z.supports(k.AN.VIDEO)))return(0,r.jsxs)("div",{className:a()(U.content,U.streamPreview,{[U.small]:el}),children:[(0,r.jsx)(S.Z,{noImage:!0,noText:!0,className:a()(U.absoluteFill,{[U.streamPreviewOpacity]:null==Q}),stream:t.stream}),n?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.a,{isSmall:el,children:(0,r.jsx)(u.Text,{variant:el?"text-sm/semibold":"text-md/semibold",color:"none",children:D<175?V.intl.string(V.t["I6JG4+"]):V.intl.string(V.t["7Xq/nZ"])})}),$?(0,r.jsx)(P.a,{className:U.addCTA,tooltip:V.intl.string(V.t.wCrzur),onClick:e=>{e.stopPropagation(),(0,c.rn)(q,{forceMultiple:!0})},isSmall:el,children:(0,r.jsx)(u.OgY,{size:"xs",color:"currentColor",className:U.addStreamIcon})}):null]})]});else return(0,r.jsxs)(r.Fragment,{children:[null!=X?(0,r.jsx)(O.Z,{focused:M,channelId:X.id,guildId:X.guild_id,streamerId:B.id,hasScreenMessage:null!=er,stream:q}):null,(0,r.jsx)(h.Z,{onResize:i,wrapperClassName:a()(U.videoWrapper,W),className:U.content,streamId:J,videoComponent:z,fit:p,paused:Y||(null==Q?void 0:Q.state)===L.jm8.PAUSED||en,videoSpinnerContext:et?f.m.SELF_STREAM:f.m.REMOTE_STREAM,userId:B.id,streamKey:t.id},J),null!=er?(0,r.jsx)(y.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({size:(0,A.L)(D)},er)):null,(0,r.jsx)(C.Z,{stream:q,inPopout:m})]})}},651183:function(e,t,n){n.d(t,{Z:()=>u});var r=n(951288);n(647438);var l=n(458725),i=n(475674),a=n(42326),o=n(388032);function u(e){let{participant:t,className:n}=e,u=(0,i.Z)(t);if(null==u)return null;let s=function(e){switch(e){case l.u.STREAM_SEND_LOW_FPS:case l.u.STREAM_SEND_HIGH_PACKET_LOSS:return o.intl.string(o.t["1f1LHh"]);case l.u.STREAM_BAD_NETWORK_QUALITY:return o.intl.string(o.t.Ic588P);case l.u.STREAM_SOUNDSHARE_FAILED:return o.intl.string(o.t["9lcycn"]);case l.u.STREAM_VIEW_HIGH_PACKET_LOSS:case l.u.STREAM_VIEW_LOW_FPS:return o.intl.string(o.t.BcOif3);default:return}}(u);return null!=s?(0,r.jsx)(a.Z,{className:n,errorMessage:s,avError:u}):null}},462061:function(e,t,n){n.d(t,{T:()=>T,Z:()=>D});var r=n(951288),l=n(647438),i=n(120356),a=n.n(i),o=n(442837),u=n(481060),s=n(475179),c=n(763520),d=n(358221),f=n(414910),p=n(502053),m=n(965048),E=n(266910),g=n(352978),b=n(928518),S=n(518950),v=n(470956),h=n(314897),O=n(271383),y=n(131951),_=n(451478),j=n(5192),Z=n(44136),I=(n(351483),n(249212)),w=n(853476),P=n(981631),A=n(65154),C=n(388032),R=n(7504);let x=u.EFr.SIZE_80,N=u.EFr.SIZE_40;function T(e){let{channelId:t,participant:n}=e;return(0,v.Eu)(t,n.id)?(0,r.jsx)(u.ua7,{text:C.intl.string(C.t.HFwRpq),position:"bottom",color:u.FGA.GREY,children:e=>{var t,n;return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={className:R.interactive,children:(0,r.jsx)(u.Mgn,{color:u.TVs.colors.STATUS_WARNING_BACKGROUND})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}}):(0,r.jsx)(w.Z,{userId:n.user.id})}function D(e){let{participant:t,channel:n,inCall:i,width:u,selected:v,fit:w,onVideoResize:T,blocked:D,ignored:M,noVideoRender:L=!1,pulseSpeakingIndicator:F=!1,inOverlayPopout:k=!1,paused:V=!1}=e,U=y.Z.getVideoComponent(),H=(0,o.e7)([h.default],()=>h.default.getId()),{user:W,streamId:Y,speaking:z}=t,G=W.id===H,K=(0,Z.ZP)(t),q=(0,o.e7)([_.Z],()=>_.Z.isFocused()),B=(0,o.e7)([b.Z],()=>b.Z.getWindowFocused(P.KJ3.CHANNEL_CALL_POPOUT)),J=(0,o.e7)([y.Z],()=>null!=W.id&&y.Z.isLocalVideoDisabled(W.id,(0,f.Z)(t.type)),[W.id,t.type]),X=(0,o.e7)([O.ZP],()=>O.ZP.isGuestOrLurker(n.guild_id,W.id)),Q=j.ZP.getName(n.getGuildId(),n.id,W)+(X?" ".concat(C.intl.string(C.t["pFO/Pj"])):""),$=z&&(B||q),ee=u<124?N:x,{avatarSrc:et,avatarDecorationSrc:en}=(0,S.Z)({userId:W.id,guildId:n.guild_id,size:ee,animateOnHover:!$}),er=(0,o.e7)([d.Z],()=>d.Z.getSelectedParticipant(n.id)),el=(0,m.Z)(A.Yn.DEFAULT,t.user.id),ei=(0,p.Z)(t.user.id),ea={channel:n,selectedParticipant:er,user:W},eo=l.useRef(ea);return(l.useEffect(()=>{eo.current=ea}),l.useEffect(()=>{let{channel:e,selectedParticipant:t,user:n}=eo.current;e.isGuildStageVoice()&&!K&&(null==t?void 0:t.id)===n.id&&s.Z.selectParticipant(e.id,null)},[K]),i&&!J&&!L&&K&&!v&&null!=U&&y.Z.supports(A.AN.VIDEO))?null!=el&&null==ei?(0,r.jsx)(I.Z,{avError:el,userId:t.id,width:u,selected:v}):(0,r.jsx)(g.Z,{onResize:T,wrapperClassName:R.videoWrapper,className:R.content,mirror:G,streamId:Y,videoComponent:U,fit:w,videoSpinnerContext:W.id===H?c.m.SELF_VIDEO:c.m.REMOTE_VIDEO,paused:V,userId:W.id},Y):(0,r.jsx)("div",{className:a()(R.content,{[R.blockedAvatar]:D||M}),children:(0,r.jsx)(E.Z,{"aria-label":Q,src:et,avatarDecoration:en,backgroundSrc:W.getAvatarURL(n.guild_id,80),size:ee,pulseSpeakingIndicator:F,speaking:z,userId:W.id})})}},853476:function(e,t,n){n.d(t,{Z:()=>u});var r=n(951288);n(647438);var l=n(458725),i=n(502053),a=n(42326),o=n(388032);function u(e){let{userId:t,className:n}=e,u=(0,i.Z)(t);if(null==u)return null;let s=u===l.u.CAMERA_SEND_LOW_FPS?o.intl.string(o.t["1NyoVl"]):void 0;return null!=s?(0,r.jsx)(a.Z,{className:n,errorMessage:s,avError:u}):null}},623825:function(e,t,n){function r(e){return e<=220}function l(e){return e<=124}n.d(t,{K:()=>r,N:()=>l})},839662:function(e,t,n){n.d(t,{Z:()=>i});var r=n(44136),l=n(354459);function i(e,t){var n,i;let a=null,o=null,u=null,s=!1,c=!1;switch(e.type){case l.fO.ACTIVITY:break;case l.fO.USER:a=e.streamId,u=e.voiceState,s=e.speaking,c=e.ringing;break;case l.fO.STREAM:a=e.streamId,o=e.stream}return{streamId:a,stream:o,speaking:s,ringing:c,muted:null!=(n=null==u?void 0:u.isVoiceMuted())&&n,deafen:null!=(i=null==u?void 0:u.isVoiceDeafened())&&i,mirror:e.type===l.fO.USER&&e.user.id===t,hasVideo:(0,r.ZP)(e)}}},42326:function(e,t,n){n.d(t,{Z:()=>g}),n(388685);var r=n(951288),l=n(647438),i=n(120356),a=n.n(i),o=n(846519),u=n(481060),s=n(458725),c=n(906467),d=n(63063),f=n(618158),p=n(981631),m=n(388032),E=n(606630);function g(e){let{errorMessage:t,className:n,avError:i}=e,g="",{text:b,node:S}=function(e){var t;if(null==e)return{text:null,node:null};let n=null==(t=(0,s.hp)(e))?void 0:t.errorCode,l=m.intl.formatToPlainString(m.t["ejOT9/"],{errorCode:n}),i=m.intl.format(m.t.If5Q0t,{errorCode:n,helpDeskURL:d.Z.getArticleURL(p.BhN.AV_ERROR_CODES)}),a=c.Z.isDeveloper;return{text:a?"".concat(l," (").concat(e,")"):l,node:a?(0,r.jsxs)(r.Fragment,{children:[i," (",e,")"]}):i}}(i);null!=t&&null!=b?g="".concat(t," ").concat(b):null!=t&&(g=t);let[v]=l.useState(new o.V7),[h,O]=l.useState(!1);function y(){v.start(250,()=>{O(!1)})}function _(){v.stop(),O(!0)}return(0,r.jsx)(u.ua7,{forceOpen:h,disableTooltipPointerEvents:!1,text:(0,r.jsx)(f.Z,{children:(0,r.jsxs)("div",{onMouseEnter:_,onMouseLeave:y,children:[t,null!=S&&(0,r.jsx)(u.Text,{variant:"text-sm/semibold",color:"text-muted",className:E.errorCodeMessage,children:S})]})}),position:"bottom",color:u.FGA.GREY,"aria-label":g,children:e=>{var t,l;return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),l=l={onMouseEnter:_,onMouseLeave:y,className:a()(n,E.root),children:(0,r.jsx)(f.Z,{children:(0,r.jsx)(u.Mgn,{onMouseEnter:_,onMouseLeave:y,size:"custom",width:20,height:20,color:"currentColor","aria-label":g,className:E.warningIcon})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(l)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}),t))}})}},456631:function(e,t,n){let r;n.d(t,{H:()=>g,Z:()=>O}),n(388685),n(290780);var l,i,a=n(392711),o=n(442837),u=n(780384),s=n(570140),c=n(70956),d=n(963838),f=n(354459);let p=[],m={},E=[],g=e=>{null!=e&&s.Z.dispatch({type:"VOICE_CHANNEL_EFFECT_CLEAR",userId:e})},b=[],S=10*c.Z.Millis.SECOND,v=(0,a.debounce)(()=>{let e=(0,d.cX)(E);u.uv.announce(e,"polite"),E=[]},500);class h extends(l=o.ZP.Store){get recentlyUsedEmojis(){return p}get isOnCooldown(){return null!=r&&new Date<r}get effectCooldownEndTime(){return r}getEffectForUserId(e){return m[e]}}(i="displayName")in h?Object.defineProperty(h,i,{value:"VoiceChannelEffectsStore",enumerable:!0,configurable:!0,writable:!0}):h[i]="VoiceChannelEffectsStore";let O=new h(s.Z,{VOICE_CHANNEL_EFFECT_CLEAR:e=>{let{userId:t}=e;null!=m[t]&&delete m[t]},VOICE_CHANNEL_EFFECT_RECENT_EMOJI:e=>{let{emoji:t}=e;null!=t&&(p.unshift(t),(p=(0,a.uniqBy)(p,"name")).length>f.e5+1&&p.pop())},VOICE_CHANNEL_EFFECT_SEND:e=>{let{emoji:t,userId:n,animationType:r}=e;null!=t&&null!=r&&(m[n]={emoji:t,sentAt:Date.now(),animationType:r},E=[...E,{emojiName:t.name,userId:n}],v())},VOICE_CHANNEL_EFFECT_SENT_LOCAL:()=>{let e=new Date;if((b=[e,...b].slice(0,20)).length>=20){let t=b[b.length-1],n=e.getTime()-t.getTime();n<S&&(r=new Date(e.getTime()+S-n))}},VOICE_CHANNEL_EFFECT_UPDATE_TIME_STAMP:e=>{let{cooldownEndsAtMs:t}=e;r=new Date(Date.now()+t)}})},274459:function(e,t,n){n.d(t,{Z:()=>b}),n(388685);var r=n(951288),l=n(647438),i=n(202841),a=n(442837),o=n(481060),u=n(596454),s=n(607070),c=n(70956),d=n(456631),f=n(181201);let p=6*c.Z.Millis.SECOND,m=2*c.Z.Millis.SECOND,E=2*c.Z.Millis.SECOND,g=e=>"scale(".concat(1- -(e/120),") rotate(").concat(e,"deg)");function b(e){let{userId:t,voiceChannelEffect:n,onComplete:c}=e,{emoji:b,sentAt:S}=n,v=(0,a.e7)([s.Z],()=>s.Z.useReducedMotion),[h,O]=l.useState(!0),y=!v,_=(0,o.Yzy)(h,{from:{rotate:-120},enter:{rotate:0},leave:{rotate:-120},config:i.config.default,onRest:(e,t)=>{let{phase:n}=t;"leave"===n&&c()}});return(l.useEffect(()=>{let e;return Date.now()-S>=E?(0,d.H)(t):e=setTimeout(()=>{O(!1),y&&(0,d.H)(t)},y?m:p),()=>{null!=e&&clearTimeout(e)}},[S,t,y]),y)?null:_((e,t)=>{var n;let{rotate:l}=e;return t&&(0,r.jsx)(i.animated.div,{className:f.voiceChannelEffectEmojiContainer,style:{transform:l.to(g)},children:(0,r.jsx)(u.Z,{className:f.voiceChannelEffectEmoji,emojiId:b.id,emojiName:b.name,animated:null!=(n=b.animated)&&n})})})}}}]);
//# sourceMappingURL=0051feed82c67e7f.js.map