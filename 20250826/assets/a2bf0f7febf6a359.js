"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["84956"],{986197:function(e,t,n){n.d(t,{Z:()=>c}),n(35282);var i=n(990547),r=n(544891),o=n(570140),a=n(881052),s=n(626135),l=n(573261),u=n(109488),d=n(981631);n(135200);var g=n(388032);let c={resetSuggestions:()=>o.Z.dispatch({type:"POMELO_SUGGESTIONS_RESET"}),async fetchSuggestionsRegistration(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;o.Z.dispatch({type:"POMELO_SUGGESTIONS_RESET"});try{var n;let i=await r.tn.get({url:d.ANM.POMELO_SUGGESTIONS_UNAUTHED,query:null==e?void 0:{global_name:e},timeout:t,rejectWithError:!0,failImmediatelyWhenRateLimited:!0});if(i.ok&&(null==(n=i.body)?void 0:n.username)!=null)return o.Z.dispatch({type:"POMELO_REGISTRATION_SUGGESTIONS_SUCCESS",suggestion:i.body,source:e})}catch(e){return}},async fetchSuggestions(e){if((0,u.P)())try{var t;o.Z.dispatch({type:"POMELO_SUGGESTIONS_FETCH",usernameSuggestionLoading:!0});let n=await r.tn.get({url:d.ANM.POMELO_SUGGESTIONS,timeout:e,rejectWithError:!0});if(n.ok&&(null==(t=n.body)?void 0:t.username)!=null)return o.Z.dispatch({type:"POMELO_SUGGESTIONS_SUCCESS",suggestion:n.body})}catch(e){return}},async attemptPomelo(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modal",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=!1===/^[A-Za-z0-9_.]*$/.test(e)?g.intl.string(g.t.z7c4bG):e.includes("..")?g.intl.string(g.t["C7G+go"]):e.length<2||e.length>32?g.intl.formatToPlainString(g.t.IpijXF,{maxNum:32,minNum:2}):void 0;if(null!=c)return s.default.track(d.rMx.POMELO_ERRORS,{reason:c,username_error:!0,location:n,one_click_flow:u}),o.Z.dispatch({type:"POMELO_ATTEMPT_FAILURE",username:e,error:c});try{let t=await l.Z.post({url:r?d.ANM.POMELO_ATTEMPT_UNAUTHED:d.ANM.POMELO_ATTEMPT,body:{username:e},trackedActionData:{event:i.NetworkActionNames.POMELO_ATTEMPT,properties:{requested_username:e}},rejectWithError:!1});t.body.taken&&s.default.track(d.rMx.POMELO_ERRORS,{reason:"already_taken",username_error:!0,location:n,one_click_flow:u}),o.Z.dispatch({type:"POMELO_ATTEMPT_SUCCESS",username:e,taken:t.body.taken})}catch(l){let i=new a.Hx(l),r=null!=(t=i.getAnyErrorMessage())?t:void 0;s.default.track(d.rMx.POMELO_ERRORS,{reason:r,username_error:!0,location:n,one_click_flow:u}),o.Z.dispatch({username:e,type:"POMELO_ATTEMPT_FAILURE",error:null!=i.status&&i.status<500&&401!==i.status?r:void 0,statusCode:i.status,retryAfter:i.retryAfter})}},async createPomelo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=await l.Z.post({body:e,url:d.ANM.POMELO_CREATE,trackedActionData:{event:i.NetworkActionNames.POMELO_CREATE,properties:{one_click_flow:t}},rejectWithError:!1});return o.Z.dispatch({type:"CURRENT_USER_UPDATE",user:n.body}),n.body}}},654344:function(e,t,n){n.d(t,{c:()=>r});let i=(0,n(818083).B)({kind:"user",label:"Pomelo Debounce Delay",id:"2023-03_pomelo_debounce_delay",defaultConfig:{delay:600},treatments:[{id:1,label:"600ms",config:{delay:600}},{id:2,label:"700ms",config:{delay:700}},{id:3,label:"800ms",config:{delay:800}},{id:4,label:"900ms",config:{delay:900}},{id:5,label:"1000ms",config:{delay:1e3}}]}),r=()=>i.useExperiment({location:"52560d_1"},{autoTrackExposure:!1}).delay},135200:function(e,t,n){n.d(t,{Z:()=>m});var i,r,o=n(31775),a=n.n(o),s=n(442837),l=n(570140),u=n(70956);let d={taken:null,error:void 0,rateLimited:!0},g={validations:new(a())({max:100,maxAge:6e4}),currentUsernameInvalid:!1,retryAfterTime:null,suggestions:{migration:{suggestion:{username:void 0},fetched:!1,usernameSuggestionLoading:!1},registration:{suggestion:{username:void 0},source:void 0,fetched:!1}}};class c extends(r=s.ZP.Store){isRateLimited(){return null!=g.retryAfterTime&&Date.now()<g.retryAfterTime}validate(e){let t=g.validations.get(e);return this.isRateLimited()&&(null==t||t.rateLimited)?d:this.isRateLimited()||null==t||!t.rateLimited?t:void 0}registrationUsernameSuggestion(){return g.suggestions.registration.suggestion.username}usernameSuggestion(){return g.suggestions.migration.suggestion.username}usernameSuggestionLoading(){return g.suggestions.migration.usernameSuggestionLoading}isCurrentUsernameInvalid(){return g.currentUsernameInvalid}wasRegistrationSuggestionFetched(e){return g.suggestions.registration.source===e&&g.suggestions.registration.fetched}wasSuggestionsFetched(){return g.suggestions.migration.fetched}}(i="displayName")in c?Object.defineProperty(c,i,{value:"PomeloStore",enumerable:!0,configurable:!0,writable:!0}):c[i]="PomeloStore";let m=new c(l.Z,{POMELO_ATTEMPT_SUCCESS:function(e){let{username:t,taken:n}=e;g.validations.set(t,{taken:n})},POMELO_ATTEMPT_FAILURE:function(e){let{username:t,error:n,statusCode:i,retryAfter:r}=e;429===i?g.validations.set(t,{taken:null,error:n,rateLimited:!0},(null!=r?r:7)*u.Z.Millis.SECOND):g.validations.set(t,{taken:null,error:n}),null!=r&&(g.retryAfterTime=Date.now()+r*u.Z.Millis.SECOND)},POMELO_SUGGESTIONS_RESET:function(){g.suggestions.migration={suggestion:{username:void 0},fetched:!1,usernameSuggestionLoading:!1},g.suggestions.registration={suggestion:{username:void 0},source:void 0,fetched:!1}},POMELO_SUGGESTIONS_SUCCESS:function(e){let{suggestion:t}=e;g.suggestions.migration={suggestion:t,fetched:!0,usernameSuggestionLoading:!1},(null==t?void 0:t.invalid_current_username)===!0&&(g.currentUsernameInvalid=!0)},POMELO_SUGGESTIONS_FETCH:function(e){let{usernameSuggestionLoading:t}=e;g.suggestions.migration.usernameSuggestionLoading=t},POMELO_REGISTRATION_SUGGESTIONS_SUCCESS:function(e){let{suggestion:t,source:n}=e;g.suggestions.registration={suggestion:t,source:n,fetched:!0},(null==t?void 0:t.username)!=null&&g.validations.set(t.username,{taken:!1})}})},109488:function(e,t,n){n.d(t,{P:()=>r});let i=(0,n(818083).B)({kind:"user",label:"Pomelo Suggestions",id:"2023-04_pomelo_suggestions",defaultConfig:{enabled:!1},treatments:[{id:1,label:"enabled",config:{enabled:!0}}]}),r=()=>i.getCurrentConfig({location:"1907ae_1"},{autoTrackExposure:!1}).enabled},219496:function(e,t,n){n.d(t,{K:()=>r});var i,r=((i={}).AVAILABLE="AVAILABLE",i.ERROR="ERROR",i.RATE_LIMIT="RATE_LIMIT",i.INTERNAL_ERROR="INTERNAL_ERROR",i)},346585:function(e,t,n){n.d(t,{K9:()=>O,NX:()=>_,R_:()=>h,e$:()=>m,ti:()=>T,zV:()=>c}),n(704826),n(35282),n(388685),n(314940);var i=n(913527),r=n.n(i),o=n(278074),a=n(768581),s=n(709054),l=n(624138),u=n(219496),d=n(801461),g=n(388032);function c(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return a.ZP.getUserAvatarURL({id:e.id,avatar:e.avatar,bot:e.bot,discriminator:"0000"},t,80)}function m(e){let t=(0,l._I)(e.username).replace(d.RN,"").replace(d.iF,".").toLowerCase();return"".concat(t).concat(e.discriminator).substring(0,32)}let E=["@","#",":"],f=["```","discord","hypesquad","system message","system mesage","sustem message","sustem mesage","clyde"],S=["discordtag","everyone","here","discord nitro","discord","snowsgiving"];function _(e){var t;let n=e.username.toLowerCase();if((t=d.kt,n.split("").filter(e=>!t.includes(e.charCodeAt(0))).join("")).length<2)return!0;for(let e of E)if(n.includes(e))return!0;for(let e of S)if(n===e.toLowerCase())return!0;for(let e of f)if(n.includes(e.toLowerCase()))return!0;return!1}function h(e){return e.toLowerCase().replace(/\s/g,"").replace("@","")}function O(e){let t=s.default.extractTimestamp(e);try{return r()(new Date(t)).format("MMM DD, YYYY")}catch(e){}return null}function T(e){return(0,o.EQ)(e).with({rateLimited:!0},()=>({type:u.K.RATE_LIMIT,message:g.intl.string(g.t.T15lqq)})).with({error:o.P.not(o.P.nullish)},e=>{let{error:t}=e;return{type:u.K.ERROR,message:t}}).with({taken:!1},()=>({type:u.K.AVAILABLE,message:g.intl.string(g.t.PgfBS0)})).with({taken:!0},()=>({type:u.K.ERROR,message:g.intl.string(g.t.mCrAUV)})).with({error:o.P.nullish},()=>({type:u.K.INTERNAL_ERROR,message:""})).otherwise(()=>void 0)}},363577:function(e,t,n){n.d(t,{M:()=>d});var i=n(647438),r=n(392711),o=n(399606),a=n(986197),s=n(654344),l=n(135200),u=n(346585);let d=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],g=(0,o.e7)([l.Z],()=>l.Z.validate(e),[e]),c=(0,o.e7)([l.Z],()=>l.Z.isRateLimited()),m=(0,s.c)(),E=i.useMemo(()=>(0,r.debounce)(e=>a.Z.attemptPomelo(e,n?"registration":"modal",n,d),m),[m,n,d]);return i.useEffect(()=>{t&&!c&&null==g&&""!==e&&E(e)},[t,c,g,e,E]),i.useMemo(()=>null!=g?(0,u.ti)(g):void 0,[g])}},807369:function(e,t,n){n.d(t,{a:()=>o}),n(388685);var i=n(647438),r=n(363577);let o=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,a=(0,r.M)(e,t,n),[s,l]=i.useState(void 0);return i.useEffect(()=>{""===e||e===o?l(void 0):null!=a&&l(a)},[a,e,o]),s}},180529:function(e,t,n){n.d(t,{Z:()=>d}),n(388685);var i,r=n(951288),o=n(647438),a=n(796075),s=n(202841),l=n(481060);let u=null!=(i=window.ResizeObserver)?i:a.d;function d(e){let{show:t,children:n,top:i=0,bottom:a=0}=e,{ref:d,height:g}=(()=>{let e=o.useRef(null),[t,n]=o.useState(0),i=o.useMemo(()=>new u(e=>{let[t]=e;return n(t.contentRect.height)}),[]);return o.useLayoutEffect(()=>(null!=e.current&&i.observe(e.current),()=>i.disconnect()),[i]),{ref:e,height:t}})(),c=(0,l.q_F)({from:{height:0,paddingBottom:"0px",marginTop:"0px"},to:{height:t?g:0,paddingBottom:t?"".concat(a,"px"):"0px",marginTop:t?"".concat(i,"px"):"0px"},config:{tension:170,friction:26}}),m=(0,l.q_F)({from:{opacity:0},to:{opacity:+!!t},config:{duration:200,easing:t?e=>e**4:e=>e*(2-e)}});return(0,r.jsx)(s.animated.div,{style:{overflow:"hidden",height:c.height,paddingBottom:c.paddingBottom,marginTop:c.marginTop},children:(0,r.jsx)(s.animated.div,{style:{opacity:m.opacity},ref:d,children:n})})}}}]);
//# sourceMappingURL=a2bf0f7febf6a359.js.map