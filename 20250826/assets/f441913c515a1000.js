"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["25761"],{26230:function(e){e.exports="/assets/e61405de377a632d.svg"},935227:function(e){e.exports="/assets/d011b96a0131b4ba.svg"},479495:function(e,t,n){n.d(t,{Z:()=>E}),n(35282);var r,s=n(951288),i=n(647438),a=n(120356),l=n.n(a),o=n(593473),c=n(873546),u=n(442837),d=n(570140),p=n(893776),h=n(129293),f=n(254942),m=n(388905),g=n(17894),y=n(124860),b=n(703656),w=n(108427),S=n(314897),O=n(585483),C=n(981631),x=n(388032),j=n(197571);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}u.ZP.initialize();class P extends(r=i.PureComponent){componentDidMount(){(0,w.e)("reset_password")}renderPasswordReset(){let{password:e,error:t,hasCancel:r,working:i}=this.state,{theme:a,authBoxClassName:l}=this.props,o=null!=t?t:this.renderError("password");return(0,s.jsxs)(m.ZP,{onSubmit:this.handleSubmit,tag:"form",theme:a,className:l,children:[(0,s.jsx)("img",{alt:"",src:null==o?n(26230):n(935227),className:j.marginBottom20}),(0,s.jsx)(m.Dx,{children:x.intl.string(x.t["1LV6Ki"])}),(0,s.jsxs)(m.gO,{className:j.marginTop20,children:[(0,s.jsx)(m.II,{label:x.intl.string(x.t["8dM4FB"]),className:j.marginBottom20,name:"password",value:e,onChange:e=>this.setState({password:e}),error:o,type:"password",autoComplete:"new-password",required:!0}),(0,s.jsx)(m.zx,{type:"submit",submitting:i,children:x.intl.string(x.t["FRep5+"])}),r?(0,s.jsx)(m.zx,{className:j.marginTop8,onClick:this.handleGoToLogin,submitting:i,color:m.zx.Colors.PRIMARY,children:x.intl.string(x.t["ETE/oK"])}):null]})]})}renderMFA(){let{mfaTicket:e,mfaMethods:t,theme:n,authBoxClassName:r,width:i}=this.props,a=e=>{let{mfaType:t,data:n}=e;return this.handleTokenSubmitMFAv2(t,n)};return(0,s.jsx)(m.ZP,{style:{padding:0},theme:n,className:r,children:(0,s.jsx)(y.Cd,{mfaFinish:a,mfaChallenge:{ticket:e,methods:t},onEarlyClose:()=>{d.Z.dispatch({type:"LOGIN_RESET"})},width:null!=i?i:480})})}renderSucceeded(){let{theme:e,authBoxClassName:t}=this.props;return(0,s.jsxs)(m.ZP,{theme:e,className:t,children:[(0,s.jsx)("img",{alt:"",src:n(26230),className:l()(j.marginBottom20,c.tq?j.marginTop20:"")}),(0,s.jsx)(m.Dx,{className:j.marginBottom40,children:x.intl.string(x.t.WAUOoK)}),(0,s.jsx)(m.zx,{onClick:this.handleOpenApp,children:x.intl.string(x.t.uJWIj4)})]})}render(){return this.state.success?this.renderSucceeded():null!=this.props.mfaTicket&&""!==this.props.mfaTicket?this.renderMFA():this.renderPasswordReset()}constructor(e){var t;super(e),v(this,"handleSubmit",async e=>{let{location:t,onLoginSuccess:n,source:r,resetToken:s}=this.props,{password:i,error:a}=this.state;if(e.preventDefault(),0===i.length){this.setState({error:x.intl.string(x.t.R98xDw)}),O.S.dispatch(C.CkL.WAVE_EMPHASIZE);return}null!=a&&this.setState({error:null});let l=s;if(null!=t&&(l=(0,h.Z)(t)),null!=l){this.setState({working:!0});try{let{result:e,sms:t,webauthn:s,ticket:a,token:o,totp:c,backup:u}=await p.Z.resetPassword(l,i,r);e===p.c.MFA?d.Z.dispatch({type:"LOGIN_MFA_STEP",ticket:a,sms:t,webauthn:s,totp:c,backup:u}):null!=n?n(o):(d.Z.dispatch({type:"LOGIN_SUCCESS",token:o}),this.handlePasswordChangeSuccess())}catch(e){this.setState({apiErrors:(0,f.p)(e)})}this.setState({working:!1})}}),v(this,"handleTokenSubmitMFAv2",async(e,t)=>{let{location:n,mfaTicket:r,onLoginSuccess:s,resetToken:i,source:a}=this.props,{password:l}=this.state;if(0===l.length)return d.Z.dispatch({type:"LOGIN_RESET"}),Promise.reject();let o=i;if(null!=n&&(o=(0,h.Z)(n)),null==o)return d.Z.dispatch({type:"LOGIN_RESET"}),Promise.reject();this.setState({working:!0});try{let n=await p.Z.resetPasswordMFAv2({method:e,code:t,ticket:r,password:l,token:o,source:a});if(null!=s)return void s(n);d.Z.dispatch({type:"LOGIN_SUCCESS",token:n}),this.handlePasswordChangeSuccess()}finally{this.setState({working:!1})}}),v(this,"handlePasswordChangeSuccess",()=>{let{replaceWith:e}=this.props;if(c.Em||c.tq)return void this.setState({success:!0});e(C.Z5c.APP)}),v(this,"handleGoToLogin",()=>{let{transitionTo:e}=this.props;p.Z.loginReset(),e(C.Z5c.LOGIN,{source:"reset_password"})}),v(this,"handleOpenApp",()=>{(0,g.Z)("password_reset")}),v(this,"hasError",e=>null!=this.state.apiErrors[e]||null!=this.state.error),v(this,"renderError",e=>{let{apiErrors:t}=this.state;if(this.hasError(e)){let n=t[e];return Array.isArray(n)?n[0]:n}return null});let n=(null==(t=this.props.location)?void 0:t.search)!=null&&""!==this.props.location.search?(0,o.parse)(this.props.location.search):null;this.state={method:"",password:"",code:"",apiErrors:{},error:null,hasCancel:null!=n&&null!=n.from_login,working:!1,success:!1}}}v(P,"defaultProps",{transitionTo:b.uL,replaceWith:b.dL});let E=function(e){let t=(0,u.cj)([S.default],()=>({mfaTicket:S.default.getMFATicket(),mfaMethods:S.default.getMFAMethods()}));return(0,s.jsx)(P,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}({},e,t))}},129293:function(e,t,n){n.d(t,{Z:()=>s}),n(35282);var r=n(593473);function s(e){let t=null!=e.hash&&""!==e.hash?(0,r.parse)(e.hash):null;if((null==t?void 0:t.token)!=null)return t.token;let n=null!=e.search&&""!==e.search?(0,r.parse)(e.search):null;return(null==n?void 0:n.token)!=null?n.token:null}},379760:function(e,t,n){n.d(t,{Z:()=>p});var r=n(951288);n(647438);var s=n(755721),i=n(481060),a=n(600164),l=n(7557),o=n(388905),c=n(388032),u=n(158017),d=n(197571);function p(e){let{title:t,subtitle:n,error:p,onSubmit:h,onCancel:f}=e;return(0,r.jsxs)(a.Z,{direction:a.Z.Direction.VERTICAL,children:[(0,r.jsx)(o.Dx,{className:d.marginBottom8,children:t}),(0,r.jsx)(o.DK,{className:u.subTitle,children:n}),(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Z,{inputClassName:u.codeInput,onSubmit:h}),null!=p?(0,r.jsx)(i.Text,{className:u.error,variant:"text-sm/normal",children:p}):null]}),null!=f&&(0,r.jsx)(s.zx,{className:u.button,onClick:f,color:s.zx.Colors.PRIMARY,children:c.intl.string(c.t["ETE/oK"])})]})}},742458:function(e,t,n){n.d(t,{Nz:()=>s,o9:()=>a}),n(35282);var r,s=((r={}).PHONE="phone",r.EMAIL="email",r);let i=/^[-() \d]+$/;function a(e,t){return"phone"===e?!t.startsWith("+"):"email"!==e&&!(t.length<3)&&i.test(t)}},541692:function(e,t,n){let r;n.d(t,{Z:()=>p});var s,i=n(442837),a=n(570140),l=n(133080);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let c=(0,l.K4)();function u(e){var t;let{countryCode:n}=e;null!=n&&(c=null!=(t=(0,l.Zz)(n))?t:(0,l.K4)())}class d extends(s=i.ZP.DeviceSettingsStore){initialize(e){null!=e&&(r=e.selectedCountryCode)}getUserAgnosticState(){return{selectedCountryCode:r}}getCountryCode(){return null!=r?r:c}}o(d,"displayName","PhoneStore"),o(d,"persistKey","PhoneStore");let p=new d(a.Z,{PHONE_SET_COUNTRY_CODE:function(e){let{countryCode:t}=e;r=t},CONNECTION_OPEN:u,SET_LOCATION_METADATA:u})},766650:function(e,t,n){n.d(t,{Z:()=>p}),n(388685);var r=n(951288),s=n(647438),i=n(120356),a=n.n(i),l=n(202841),o=n(481060),c=n(144114),u=n(317175),d=n(33048);function p(e){let{show:t,alpha2:n,countryCode:i}=e,p=s.useRef(null),h=s.useRef(null),[f,m]=s.useState(0),[g,y]=s.useState(!1);s.useEffect(()=>{function e(){var e,n;m(t&&null!=(n=null==(e=h.current)?void 0:e.getBoundingClientRect().width)?n:0)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t,n,i]);let b=(0,o.q_F)({width:"".concat(f,"px"),onStart:()=>{y(!0)},onRest:()=>{y(!1)}});return(0,r.jsx)(o.yRy,{targetElementRef:p,position:"top",renderPopout:e=>(0,r.jsx)(u.Z,{className:d.popout,onClick:t=>{c.Z.setCountryCode(t),e.closePopout()}}),children:e=>{var s,c;return(0,r.jsx)("div",{className:a()(d.outerContainer,{[d.hidden]:!(t||g)}),ref:p,children:(0,r.jsx)(l.animated.div,{className:d.container,style:b,children:(0,r.jsxs)("div",{className:d.innerContainer,ref:h,children:[(0,r.jsxs)(o.P3F,(s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),c=c={className:d.countryCode,children:[n," ",i]},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(c)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(c,e))}),s)),(0,r.jsx)("div",{className:d.separator})]})})})}})}},952802:function(e,t,n){n.d(t,{Z:()=>f}),n(388685);var r=n(951288),s=n(647438),i=n(120356),a=n.n(i),l=n(755721),o=n(481060),c=n(313201),u=n(742458),d=n(766650),p=n(584090),h=n(979712);function f(e){let{alpha2:t,countryCode:n,forceMode:i,label:f,error:m,className:g,required:y,value:b,setRef:w,placeholder:S,autoFocus:O,maxLength:C,spellCheck:x,autoComplete:j,autoCapitalize:v,autoCorrect:P,onChange:E,inputClassName:N}=e,A=(0,c.Dt)(),[k,T]=s.useState(!1),Z=(0,u.o9)(i,b);return(0,r.jsx)(o.xJW,{title:f,error:m,className:g,required:y,tag:"label",htmlFor:A,children:(0,r.jsxs)("div",{className:a()(h.input,p.input,N,{[h.error]:null!=m,[h.focused]:k}),children:[(0,r.jsx)(d.Z,{show:Z,alpha2:t,countryCode:n}),(0,r.jsx)(l.Is,{id:A,name:"email",type:i===u.Nz.EMAIL?"email":"text",value:b,inputRef:w,placeholder:S,"aria-label":f,required:y,onChange:function(e){let t=(0,u.o9)(i,e)?n:"";E(e,t)},autoComplete:j,autoCapitalize:v,autoCorrect:P,autoFocus:O,maxLength:C,spellCheck:x,className:p.inputWrapper,inputClassName:p.inputField,onFocus:()=>T(!0),onBlur:()=>T(!1)})]})})}},901375:function(e,t,n){n.d(t,{j:()=>u}),n(49124);var r=n(533126),s=n(570140),i=n(893776),a=n(579806),l=n(626135),o=n(365007),c=n(981631);async function u(e){let{abortController:t,loginSource:n,giftCodeSKUId:u}=e;try{if(null==a.Z&&null!=window.PublicKeyCredential&&null!=PublicKeyCredential.isConditionalMediationAvailable){if(!await PublicKeyCredential.isConditionalMediationAvailable())return;let{challenge:e,ticket:a}=await (0,o.us)(),d=(0,r.wz)(JSON.parse(e));d.signal=t.signal;let p=await (0,r.U2)(d);s.Z.dispatch({type:"PASSWORDLESS_START"}),l.default.track(c.rMx.LOGIN_ATTEMPTED,{source:c.uRl.PASSWORDLESS_CONDITIONAL_UI,login_method:"passwordless",login_source:n,gift_code_sku_id:u}),await i.Z.loginWebAuthn({ticket:a,credential:JSON.stringify(p),source:n,giftCodeSKUId:u})}}catch(e){}}},533126:function(e,t,n){function r(e){let t="==".slice(0,(4-e.length%4)%4),n=atob(e.replace(/-/g,"+").replace(/_/g,"/")+t),r=new ArrayBuffer(n.length),s=new Uint8Array(r);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return r}function s(e){let t=new Uint8Array(e),n="";for(let e of t)n+=String.fromCharCode(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}n.d(t,{U2:()=>y,wz:()=>g});var i="copy",a="convert";function l(e,t,n){if(t===i)return n;if(t===a)return e(n);if(t instanceof Array)return n.map(n=>l(e,t[0],n));if(t instanceof Object){let r={};for(let[s,i]of Object.entries(t)){if(i.derive){let e=i.derive(n);void 0!==e&&(n[s]=e)}if(!(s in n)){if(i.required)throw Error(`Missing key: ${s}`);continue}if(null==n[s]){r[s]=null;continue}r[s]=l(e,i.schema,n[s])}return r}}function o(e,t){return{required:!0,schema:e,derive:t}}function c(e){return{required:!0,schema:e}}function u(e){return{required:!1,schema:e}}var d={type:c(i),id:c(a),transports:u(i)},p={appid:u(i),appidExclude:u(i),credProps:u(i)},h={appid:u(i),appidExclude:u(i),credProps:u(i)};c({rp:c(i),user:c({id:c(a),name:c(i),displayName:c(i)}),challenge:c(a),pubKeyCredParams:c(i),timeout:u(i),excludeCredentials:u([d]),authenticatorSelection:u(i),attestation:u(i),extensions:u(p)}),u(i),c(i),c(i),c(a),u(i),c({clientDataJSON:c(a),attestationObject:c(a),transports:o(i,e=>{var t;return(null==(t=e.getTransports)?void 0:t.call(e))||[]})}),o(h,e=>e.getClientExtensionResults());var f={mediation:u(i),publicKey:c({challenge:c(a),timeout:u(i),rpId:u(i),allowCredentials:u([d]),userVerification:u(i),extensions:u(p)}),signal:u(i)},m={type:c(i),id:c(i),rawId:c(a),authenticatorAttachment:u(i),response:c({clientDataJSON:c(a),authenticatorData:c(a),signature:c(a),userHandle:c(a)}),clientExtensionResults:o(h,e=>e.getClientExtensionResults())};function g(e){return l(r,f,e)}async function y(e){let t=await navigator.credentials.get(e);return t.toJSON=()=>l(s,m,t),t}}}]);
//# sourceMappingURL=f441913c515a1000.js.map