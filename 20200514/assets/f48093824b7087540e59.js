"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["64714"],{694312:function(e,t,n){n.d(t,{E:function(){return p}}),n(47120);var i=n(470079),l=n(442837),r=n(835473),a=n(594174),o=n(695103),u=n(823379),c=n(358085),d=n(317381),s=n(761122);function p(e){let t=(0,l.e7)([a.default],a.default.getCurrentUser),n=(0,l.Wu)([d.ZP],()=>d.ZP.getShelfActivities(e)),p=(0,l.e7)([o.Z],()=>o.Z.testModeEmbeddedApplicationId),f=n.map(e=>e.application_id),v=null!=p?[p,...f]:f,h=(0,r.Z)(v),Z=i.useMemo(()=>h.filter(u.lm),[h]),_=i.useMemo(()=>null!=p&&Z.length>0&&Z[0].id===p&&null!=Z[0].embeddedActivityConfig?[{activity:Z[0].embeddedActivityConfig,application:Z[0]}]:[],[Z,p]),g=i.useMemo(()=>n.map(e=>{let t=Z.find(t=>t.id===e.application_id);return null==t?null:{activity:e,application:t}}).filter(u.lm),[n,Z]);return i.useMemo(()=>[..._,...g].filter(e=>{var t;let{activity:n}=e;return(null!==(t=n.supported_platforms)&&void 0!==t?t:[]).includes((0,s.Z)((0,c.getOS)()))}).filter(e=>{let{activity:n}=e;return!n.requires_age_gate||(null==t?void 0:t.nsfwAllowed)===!0||(null==t?void 0:t.nsfwAllowed)==null}),[null==t?void 0:t.nsfwAllowed,g,_])}},127255:function(e,t,n){n.d(t,{Z:function(){return p}}),n(789020),n(47120),n(653041);var i=n(470079),l=n(442837),r=n(630388),a=n(115130),o=n(844797),u=n(694312),c=n(405625),d=n(664097),s=n(981631);function p(e){let{guildId:t,enableFilter:n=!1,channel:p}=e,{filter:f}=(0,l.cj)([a.Z],()=>({filter:a.Z.getFilter()})),v=(0,u.E)(t),h=(0,c.Z)(v),Z=(0,d.o)(),_=(0,o.oy)(p);return i.useMemo(()=>{function e(e){return!!(!n||""===f||e.application.name.toLowerCase().includes(f.toLowerCase()))||!1}function t(e){return!_||(0,r.yE)(e.application.flags,s.udG.EMBEDDED_RELEASED)}let i=[...Z].filter(e).filter(t),l=new Set(i.map(e=>e.application.id));for(let n of h)!l.has(n.application.id)&&e(n)&&t(n)&&i.push(n);return i},[Z,n,f,h,_])}},405625:function(e,t,n){n.d(t,{Z:function(){return c}}),n(653041),n(47120);var i=n(470079),l=n(911969),r=n(822245),a=n(675478),o=n(358085),u=n(761122);function c(e){return a.DZ.loadIfNecessary(),i.useMemo(()=>{let t=[];e.forEach(e=>t.push(e.application.id));let n=[...t];return n.sort((e,n)=>{let i=r.Z.getScoreWithoutLoadingLatest(e),l=r.Z.getScoreWithoutLoadingLatest(n);return i!==l?l-i:t.findIndex(t=>t===e)<t.findIndex(e=>e===n)?-1:1}),d(e,n)},[e])}let d=(e,t)=>{let n=[...e],i=0;return t.forEach(e=>{let t=n.findIndex(t=>t.application.id===e);if(-1!==t){let e=n[t];n.splice(t,1),n=[...n.slice(0,i),e,...n.slice(i)],++i}}),n.map((e,t)=>[e,t]).filter(e=>{var t,n;let[i]=e,r=null===(n=i.application.embeddedActivityConfig)||void 0===n?void 0:null===(t=n.client_platform_config[(0,u.Z)((0,o.getOS)())])||void 0===t?void 0:t.label_type;return!!r&&(r===l.ww.NEW||r===l.ww.UPDATED)}).forEach(e=>{let[t,i]=e,l=null!=t.application.embeddedActivityConfig&&null!=t.application.embeddedActivityConfig.shelf_rank?t.application.embeddedActivityConfig.shelf_rank-1:i;if(l<i){let e=n[i];n.splice(i,1),n=[...n.slice(0,l),e,...n.slice(l)]}}),n}},664097:function(e,t,n){n.d(t,{o:function(){return o}});var i=n(470079),l=n(442837),r=n(115130),a=n(701488);let o=()=>{let{isEnabled:e,lastUsedObject:t}=(0,l.cj)([r.Z],()=>({isEnabled:r.Z.getIsEnabled(),lastUsedObject:r.Z.getLastUsedObject()}),[]),n=(0,l.Wu)([r.Z],()=>r.Z.getDeveloperShelfItems(),[]);return i.useMemo(()=>e?n.map(e=>({application:e,activity:{...a.wT,...e.embeddedActivityConfig,application_id:e.id}})).sort((e,n)=>{let i=t[e.application.id],l=t[n.application.id];return null==i?1:null==l?-1:l-i}):[],[n,e,t])}},619915:function(e,t,n){n.d(t,{QN:function(){return s},ZP:function(){return d},gb:function(){return p},uF:function(){return f}}),n(47120),n(653041);var i=n(470079),l=n(442837),r=n(835473),a=n(158776),o=n(594174),u=n(823379),c=n(317381);function d(e,t){return p((0,l.Wu)([c.ZP],()=>null!=e&&null!=e.id&&""!==e.id?c.ZP.getEmbeddedActivitiesForChannel(e.id):c.i6),t)}function s(e){let t=p((0,l.e7)([c.ZP],()=>null!=e?c.ZP.getEmbeddedActivitiesForGuild(e):c.i6));return i.useMemo(()=>{let e=new Map;return t.forEach(t=>{var n;let i=t.embeddedActivity.channelId,l=null!==(n=e.get(i))&&void 0!==n?n:[];l.push(t),e.set(i,l)}),e},[t])}function p(e,t){let n=e.map(e=>e.applicationId),a=(0,r.Z)(n),c=new Set([]);for(let t of e)for(let e of t.userIds)c.add(e);let d=(0,l.Wu)([o.default],()=>{let e=[];for(let t of c)e.push(o.default.getUser(t));return e},[c]);return i.useMemo(()=>{let n=new Map;return d.forEach(e=>{null!=e&&n.set(e.id,e)}),e.map((e,i)=>{let l=a[i],r=[];if(null!=r)for(let i of e.userIds){let e=n.get(i);if(null!=e&&null!=t){let n=t(e);null!=n&&r.push(n)}}return null==l?null:{embeddedActivity:e,application:l,userParticipantAvatarUrls:r}}).filter(u.lm)},[e,a,d,t])}function f(e){return(0,l.e7)([a.Z],()=>{let t=new Map;return e.forEach(e=>{var n;let i=a.Z.findActivity(null==e?void 0:e.embeddedActivity.userIds.values().next().value,t=>{var n;return t.application_id===(null==e?void 0:null===(n=e.application)||void 0===n?void 0:n.id)});t.set(null==e?void 0:null===(n=e.application)||void 0===n?void 0:n.id,{...e,presenceActivity:i})}),t},[e],l.pF)}},880308:function(e,t,n){n.d(t,{g:function(){return c}});var i=n(470079),l=n(442837),r=n(695346),a=n(115130),o=n(566620),u=n(782769);function c(){let e=(0,u.z)(),t=r.Sb.getSetting(),n=(0,l.e7)([a.Z],()=>a.Z.getFetchState(),[]);return i.useEffect(()=>{e&&t&&null==n&&(0,o.$h)()},[e,n,t]),null}},361213:function(e,t,n){n.d(t,{Z:function(){return l}});var i=n(981631);function l(e,t){let n;let l=window.GLOBAL_ENV.CDN_HOST,r=window.GLOBAL_ENV.API_ENDPOINT;return n=null!=l?"".concat(location.protocol,"//").concat(l,"/app-assets/").concat(e,"/store/").concat(t,".mp4"):"".concat(location.protocol).concat(r).concat(i.ANM.STORE_ASSET(e,t,"mp4"))}},542094:function(e,t,n){n.d(t,{JS:function(){return i},Qv:function(){return A},ZP:function(){return I},w1:function(){return y}}),n(757143);var i,l,r=n(442837),a=n(911969),o=n(906732),u=n(835473),c=n(592125),d=n(358085),s=n(317381),p=n(638880),f=n(146936),v=n(619915),h=n(761122),Z=n(361213),_=n(716600),g=n(952561),m=n(778569),E=n(701488);(l=i||(i={}))[l.START=0]="START",l[l.JOIN=1]="JOIN",l[l.LEAVE=2]="LEAVE";function I(e){let{activityItem:t,channel:n,guildId:i,locationObject:l,onActivityItemSelected:r,embeddedActivitiesManager:o,assetNames:u=["embedded_cover"],backgroundResolution:c=250}=e,{application:s,activity:p}=t,f=p.client_platform_config[(0,h.Z)((0,d.getOS)())],_=null!=f.label_until&&Date.now()<Date.parse(f.label_until),g=(0,m.Z)({applicationId:s.id,size:c,names:u}),I=null!=p.activity_preview_video_asset_id?(0,Z.Z)(s.id,p.activity_preview_video_asset_id):null,w=(0,v.ZP)(n).find(e=>{let{embeddedActivity:t}=e;return s.id===t.applicationId}),b=A({channelId:null==n?void 0:n.id,applicationId:s.id}),C=y({applicationId:t.application.id,channelId:null==n?void 0:n.id,guildId:i,locationObject:l,embeddedActivitiesManager:o,onActivityItemSelectedProp:r}),S=t.activity.client_platform_config[(0,h.Z)((0,d.getOS)())].release_phase,T=E.eB.includes(S)?S.replace("_"," ").replace(/(^\w|\s\w)/g,e=>e.toUpperCase()):void 0;return{imageBackground:g,videoUrl:I,joinableEmbeddedApp:w,activityAction:b,onActivityItemSelected:C,labelType:_?f.label_type:a.ww.NONE,staffReleasePhase:T}}function A(e){let{channelId:t,applicationId:n}=e,i=0,l=(0,r.e7)([c.Z],()=>c.Z.getChannel(t)),a=(0,_.Z)(),o=(0,g.Z)(),d=(0,u.q)(n),s=(0,v.ZP)(l).find(e=>{let{embeddedActivity:t}=e;return null!=d&&d.id===t.applicationId});return null==d?i:(null!=l&&(null==a?void 0:a.channelId)===l.id&&(null==o?void 0:o.id)===d.id?i=2:null!=s&&(i=1),i)}function y(e){let{applicationId:t,channelId:n,guildId:i,locationObject:l,embeddedActivitiesManager:r,onActivityItemSelectedProp:a}=e,u=A({channelId:n,applicationId:t}),c=(0,g.Z)(),{analyticsLocations:d}=(0,o.ZP)();switch(u){case 0:return()=>{(0,f.Z)({targetApplicationId:t,currentEmbeddedApplication:c,locationObject:l,guildId:i,channelId:n,embeddedActivitiesManager:r,analyticsLocations:d}).then(e=>e&&(null==a?void 0:a({applicationId:t})))};case 1:return()=>{!s.ZP.isLaunchingActivity()&&(0,p.Z)({applicationId:t,currentEmbeddedApplication:c,activityChannelId:n,locationObject:l,embeddedActivitiesManager:r,analyticsLocations:d}).then(e=>e&&(null==a?void 0:a({applicationId:t})))};case 2:return()=>{!s.ZP.isLaunchingActivity()&&(null!=n&&r.leaveActivity({channelId:n,applicationId:t}),null==a||a({applicationId:t}))}}}},427996:function(e,t,n){n.d(t,{W:function(){return d}});var i=n(735250);n(470079);var l=n(399606),r=n(481060),a=n(337682),o=n(115130),u=n(689938),c=n(903526);function d(e){let{hideSearch:t}=e,{activityUrlOverride:n,useActivityUrlOverride:d,filter:s}=(0,l.cj)([o.Z],()=>({activityUrlOverride:o.Z.getActivityUrlOverride(),useActivityUrlOverride:o.Z.getUseActivityUrlOverride(),filter:o.Z.getFilter()}),[]);return(0,i.jsxs)("div",{className:c.container,children:[(0,i.jsx)(r.Checkbox,{type:r.Checkbox.Types.INVERTED,className:c.__invalid_checkbox,value:d,onClick:a.Y$,children:(0,i.jsx)(r.Text,{variant:"text-md/semibold",children:u.Z.Messages.EMBEDDED_ACTIVITIES_USE_ACTIVITY_URL_OVERRIDE})}),(0,i.jsx)(r.FormItem,{className:c.__invalid_urlOverride,title:u.Z.Messages.EMBEDDED_ACTIVITIES_ACTIVITY_URL_OVERRIDE,children:(0,i.jsx)(r.TextInput,{disabled:!d,value:null!=n?n:void 0,onChange:a.jS,placeholder:"http://localhost:3000"})}),!0===t?null:(0,i.jsx)("div",{children:(0,i.jsx)(r.SearchBar,{className:c.searchBar,query:s,onChange:a.a8,onClear:function(){a.a8("")}})})]})}}}]);
//# sourceMappingURL=f48093824b7087540e59.js.map